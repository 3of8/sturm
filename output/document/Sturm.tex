%
\begin{isabellebody}%
\def\isabellecontext{Sturm}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Sturm\isanewline
\isakeyword{imports}\ {\isachardoublequoteopen}{\isachartilde}{\isachartilde}{\isacharslash}src{\isacharslash}HOL{\isacharslash}Library{\isacharslash}Poly{\isacharunderscore}Deriv{\isachardoublequoteclose}\ Sturm{\isacharunderscore}Library\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isamarkupsection{\isa{sign{\isacharunderscore}changes} function%
}
\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ sign{\isacharunderscore}changes\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ {\isacharparenleft}x{\isacharcolon}{\isacharcolon}real{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ length\ {\isacharparenleft}group\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}{\isacharparenright}\ ps{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}distrib{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ sign{\isacharunderscore}changes\ {\isacharparenleft}ps\isactrlsub {\isadigit{1}}\ {\isacharat}\ {\isacharbrackleft}p{\isacharbrackright}\ {\isacharat}\ ps\isactrlsub {\isadigit{2}}{\isacharparenright}\ x\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ sign{\isacharunderscore}changes\ {\isacharparenleft}ps\isactrlsub {\isadigit{1}}\ {\isacharat}\ {\isacharbrackleft}p{\isacharbrackright}{\isacharparenright}\ x\ {\isacharplus}\ sign{\isacharunderscore}changes\ {\isacharparenleft}{\isacharbrackleft}p{\isacharbrackright}\ {\isacharat}\ ps\isactrlsub {\isadigit{2}}{\isacharparenright}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def\ sgn{\isacharunderscore}zero{\isacharunderscore}iff{\isacharcomma}\ subst\ group{\isacharunderscore}append{\isacharcomma}\ simp{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ same{\isacharunderscore}signs{\isacharunderscore}imp{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}length\ ps\ {\isacharequal}\ length\ ps{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isacharless}\ length\ ps{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}ps{\isacharbang}i{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}ps{\isacharprime}{\isacharbang}i{\isacharparenright}\ y{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \isacommand{from}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}{\isacharparenright}\ ps\ {\isacharequal}\ map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ y{\isacharparenright}{\isacharparenright}\ ps{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ rule{\isacharcolon}\ list{\isacharunderscore}induct{\isadigit{2}}{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackright}{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{1}}\ p\ ps\ p{\isacharprime}\ ps{\isacharprime}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i{\isacharless}length\ ps{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}ps{\isacharprime}\ {\isacharbang}\ i{\isacharparenright}\ y{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ this{\isacharbrackright}\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ A{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ same{\isacharunderscore}signs{\isacharunderscore}imp{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharprime}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymforall}p\ {\isasymin}\ set\ ps{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ y{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ same{\isacharunderscore}signs{\isacharunderscore}imp{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}sturm{\isacharunderscore}triple{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ r\ x{\isacharparenright}\ {\isacharequal}\ {\isacharminus}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharbrackleft}p{\isacharcomma}q{\isacharcomma}r{\isacharbrackright}\ x\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}insert\ assms{\isacharcomma}\ auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}real{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps\ {\isacharequal}\ \isanewline
\ \ \ \ length\ {\isacharparenleft}group\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}map\ poly{\isacharunderscore}inf\ ps{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharequal}\ \isanewline
\ \ \ \ length\ {\isacharparenleft}group\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}map\ poly{\isacharunderscore}neg{\isacharunderscore}inf\ ps{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}%
\isamarkupsection{Definition of Sturm sequences locale%
}
\isamarkuptrue%
\isacommand{locale}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharequal}\isanewline
\ \ \isakeyword{fixes}\ ps\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}real\ poly{\isacharparenright}\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ last{\isacharunderscore}ps{\isacharunderscore}sgn{\isacharunderscore}const{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ ps{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ ps{\isacharparenright}\ y{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ ps{\isacharunderscore}not{\isacharunderscore}Nil{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ps\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ signs{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}i\ x{\isachardot}\ {\isasymlbrakk}i\ {\isacharless}\ length\ ps\ {\isacharminus}\ {\isadigit{2}}{\isacharsemicolon}\ poly\ {\isacharparenleft}ps\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ {\isacharparenleft}poly\ {\isacharparenleft}ps\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x{\isacharparenright}\ {\isacharasterisk}\ {\isacharparenleft}poly\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ x{\isacharparenright}\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{locale}\isamarkupfalse%
\ sturm{\isacharunderscore}seq\ {\isacharequal}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharplus}\ \isanewline
\ \ \isakeyword{fixes}\ p\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}real\ poly{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ hd{\isacharunderscore}ps{\isacharunderscore}p{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}hd\ ps\ {\isacharequal}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ length{\isacharunderscore}ps{\isacharunderscore}ge{\isacharunderscore}{\isadigit{2}}{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}length\ ps\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ deriv{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}x\isactrlsub {\isadigit{0}}{\isachardot}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p\ {\isacharasterisk}\ ps{\isacharbang}{\isadigit{1}}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharcolon}\ {\isachardoublequoteopen}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ ps{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\isachardot}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ ps{\isacharunderscore}first{\isacharunderscore}two{\isacharcolon}\isanewline
\ \ \ \ \isakeyword{obtains}\ q\ ps{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}ps\ {\isacharequal}\ p\ {\isacharhash}\ q\ {\isacharhash}\ ps{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}ps{\isacharunderscore}p\ length{\isacharunderscore}ps{\isacharunderscore}ge{\isacharunderscore}{\isadigit{2}}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ ps{\isacharcomma}\ simp{\isacharcomma}\ clarsimp{\isacharcomma}\ rename{\isacharunderscore}tac\ ps{\isacharprime}{\isacharcomma}\ case{\isacharunderscore}tac\ ps{\isacharprime}{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ ps{\isacharunderscore}first{\isacharcolon}\ {\isachardoublequoteopen}ps\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ p{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ ps{\isacharunderscore}first{\isacharunderscore}two{\isacharcomma}\ simp{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\ \ \isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ {\isasymin}\ set\ ps{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}in{\isacharunderscore}set{\isacharbrackleft}OF\ ps{\isacharunderscore}not{\isacharunderscore}Nil{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{locale}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isacharequal}\ sturm{\isacharunderscore}seq\ {\isacharplus}\isanewline
\ \ \isakeyword{assumes}\ p{\isacharunderscore}squarefree{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ {\isasymnot}{\isacharparenleft}poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}\ {\isasymand}\ poly\ {\isacharparenleft}ps{\isacharbang}{\isadigit{1}}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymnot}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharunderscore}Cons{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharparenleft}p{\isacharhash}ps{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}ps\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ ps{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}unfold{\isacharunderscore}locales{\isacharparenright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}ps\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ fact\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{interpret}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isachardoublequoteopen}p{\isacharhash}ps{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ y\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ last{\isacharunderscore}ps{\isacharunderscore}sgn{\isacharunderscore}const\ \isakeyword{and}\ {\isacharbackquoteopen}ps\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ ps{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ ps{\isacharparenright}\ y{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{interpret}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isachardoublequoteopen}p{\isacharhash}ps{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ i\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ ps\ {\isacharminus}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}ps\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ signs{\isacharbrackleft}of\ {\isachardoublequoteopen}i{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharparenleft}ps\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharasterisk}\ poly\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsection{Auxiliary lemmas about roots and sign changes%
}
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ {\isacharminus}{\isacharparenright}\ sturm{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}aux{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}ps\ {\isacharcolon}{\isacharcolon}\ real\ poly\ list{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}ps\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymAnd}i\ x{\isachardot}\ {\isasymlbrakk}i\ {\isacharless}\ length\ ps\ {\isacharminus}\ {\isadigit{2}}{\isacharsemicolon}\ poly\ {\isacharparenleft}ps\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}ps\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ {\isacharminus}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}j{\isasymle}i{\isacharplus}{\isadigit{1}}{\isachardot}\ poly\ {\isacharparenleft}ps\ {\isacharbang}\ j{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ i{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}clarsimp{\isacharcomma}\ rename{\isacharunderscore}tac\ j{\isacharcomma}\ case{\isacharunderscore}tac\ j{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ i{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ Suc{\isachardot}prems{\isacharparenleft}{\isadigit{1}}{\isacharcomma}{\isadigit{2}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ {\isacharparenleft}ps\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ {\isacharminus}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ assms{\isacharparenleft}{\isadigit{4}}{\isacharparenright}{\isacharparenright}\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ Suc{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharparenleft}ps\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sgn{\isacharunderscore}zero{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ Suc{\isachardot}prems\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}j{\isasymle}i{\isacharplus}{\isadigit{1}}{\isachardot}\ poly\ {\isacharparenleft}ps\ {\isacharbang}\ j{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ Suc{\isachardot}IH{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ Suc{\isachardot}prems{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}clarsimp{\isacharcomma}\ rename{\isacharunderscore}tac\ j{\isacharcomma}\ case{\isacharunderscore}tac\ {\isachardoublequoteopen}j\ {\isacharequal}\ Suc\ {\isacharparenleft}Suc\ i{\isacharparenright}{\isachardoublequoteclose}{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This function splits the sign list of a Sturm sequence at a 
  position \isa{x} that is not a root of \isa{p} into a 
  list of sublists such that the number of sign changes within 
  every sublist is constant in the neighbourhood of \isa{x},
  thus proving that the total number is also constant.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ split{\isacharunderscore}sign{\isacharunderscore}changes\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}split{\isacharunderscore}sign{\isacharunderscore}changes\ {\isacharbrackleft}p{\isacharbrackright}\ {\isacharparenleft}x\ {\isacharcolon}{\isacharcolon}\ real{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackleft}p{\isacharbrackright}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
{\isachardoublequoteopen}split{\isacharunderscore}sign{\isacharunderscore}changes\ {\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}\ x\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
{\isachardoublequoteopen}split{\isacharunderscore}sign{\isacharunderscore}changes\ {\isacharparenleft}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\ {\isacharequal}\isanewline
\ \ \ \ {\isacharparenleft}if\ poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ poly\ q\ x\ {\isacharequal}\ {\isadigit{0}}\ then\ \isanewline
\ \ \ \ \ \ \ {\isacharbrackleft}p{\isacharcomma}q{\isacharcomma}r{\isacharbrackright}\ {\isacharhash}\ split{\isacharunderscore}sign{\isacharunderscore}changes\ {\isacharparenleft}r{\isacharhash}ps{\isacharparenright}\ x\isanewline
\ \ \ \ \ else\isanewline
\ \ \ \ \ \ \ {\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}\ {\isacharhash}\ split{\isacharunderscore}sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharparenright}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}subset{\isacharbrackleft}dest{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}ps{\isacharprime}\ {\isasymin}\ set\ {\isacharparenleft}split{\isacharunderscore}sign{\isacharunderscore}changes\ ps\ x{\isacharparenright}\ {\isasymLongrightarrow}\ set\ ps{\isacharprime}\ {\isasymsubseteq}\ set\ ps{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}insert\ ps{\isacharunderscore}not{\isacharunderscore}Nil{\isacharparenright}\isanewline
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}induction\ ps\ x\ rule{\isacharcolon}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isachardot}induct{\isacharparenright}\isanewline
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharcomma}\ simp{\isacharcomma}\ rename{\isacharunderscore}tac\ p\ q\ r\ ps\ x{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ case{\isacharunderscore}tac\ {\isachardoublequoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ poly\ q\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\isacommand{done}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
A custom induction rule for \isa{split{\isacharunderscore}sign{\isacharunderscore}changes} that 
  uses the fact that all the intermediate parameters in calls 
  of \isa{split{\isacharunderscore}sign{\isacharunderscore}changes} are quasi-Sturm sequences.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharparenright}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}induct{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}{\isasymlbrakk}{\isasymAnd}p\ x{\isachardot}\ P\ {\isacharbrackleft}p{\isacharbrackright}\ x{\isacharsemicolon}\ {\isasymAnd}p\ q\ x{\isachardot}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}\ {\isasymLongrightarrow}\ P\ {\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}\ x{\isacharsemicolon}\isanewline
\ \ \ \ {\isasymAnd}p\ q\ r\ ps\ x{\isachardot}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharparenleft}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ {\isasymlbrakk}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ poly\ q\ x\ {\isacharequal}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ P\ {\isacharparenleft}r{\isacharhash}ps{\isacharparenright}\ x{\isacharsemicolon}\ \isanewline
\ \ \ \ \ \ \ \ poly\ q\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ P\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ P\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x{\isasymrbrakk}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ P\ {\isacharparenleft}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x{\isasymrbrakk}\ {\isasymLongrightarrow}\ P\ ps\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ goal{\isadigit{1}}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ ps{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ ps\ x\ rule{\isacharcolon}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isachardot}induct{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{3}}\ p\ q\ r\ ps\ x{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{5}}{\isacharparenright}{\isacharbrackleft}OF\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{6}}{\isacharparenright}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ q\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{6}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharparenleft}r{\isacharhash}ps{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ dest{\isacharcolon}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharunderscore}Cons{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{3}}\ A\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}r\ {\isacharhash}\ ps{\isacharparenright}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}poly\ q\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{6}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ dest{\isacharcolon}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharunderscore}Cons{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{3}}\ A\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}q\ {\isacharhash}\ r\ {\isacharhash}\ ps{\isacharparenright}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{6}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ dest{\isacharcolon}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharunderscore}Cons{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{3}}\ A\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}P\ {\isacharparenleft}q\ {\isacharhash}\ r\ {\isacharhash}\ ps{\isacharparenright}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ simp{\isacharunderscore}all\ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The total number of sign changes in the split list is the same
  as the number of sign changes in the original list.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharparenright}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}correct{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}hd\ ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharprime}\ {\isasymequiv}\ {\isasymlambda}ps\ x{\isachardot}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymSum}ps{\isacharprime}{\isasymleftarrow}split{\isacharunderscore}sign{\isacharunderscore}changes\ ps\ x{\isachardot}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharprime}\ ps\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ x\isactrlsub {\isadigit{0}}\ rule{\isacharcolon}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}induct{\isacharparenright}\isanewline
\isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{3}}\ p\ q\ r\ ps\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ IH\ {\isacharequal}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharcomma}{\isadigit{4}}{\isacharparenright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{3}}\ \isacommand{interpret}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isachardoublequoteopen}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ signs{\isacharbrackleft}of\ {\isadigit{0}}{\isacharbrackright}\ \isakeyword{and}\ True\ \isacommand{have}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ sgn{\isacharunderscore}r{\isacharunderscore}x{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isacharasterisk}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{3}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}distrib{\isacharbrackleft}OF\ this{\isacharcomma}\ of\ {\isachardoublequoteopen}{\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}{\isachardoublequoteclose}\ ps{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ {\isacharparenleft}{\isacharbrackleft}p{\isacharcomma}\ q{\isacharcomma}\ r{\isacharbrackright}{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isacharplus}\ sign{\isacharunderscore}changes\ {\isacharparenleft}r\ {\isacharhash}\ ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}r{\isacharhash}ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ sign{\isacharunderscore}changes{\isacharprime}\ {\isacharparenleft}r{\isacharhash}ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{5}}{\isacharparenright}{\isacharbackquoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ IH{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharprime}{\isacharunderscore}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ True\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}distrib{\isacharbrackleft}OF\ this{\isacharcomma}\ of\ {\isachardoublequoteopen}{\isacharbrackleft}p{\isacharbrackright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}r{\isacharhash}ps{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ {\isacharparenleft}{\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isacharplus}\ sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ sign{\isacharunderscore}changes{\isacharprime}\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ IH{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharprime}{\isacharunderscore}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ False\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def\ sign{\isacharunderscore}changes{\isacharprime}{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharparenright}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}correct{\isacharunderscore}nbh{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}hd\ ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharprime}\ {\isasymequiv}\ {\isasymlambda}x\isactrlsub {\isadigit{0}}\ ps\ x{\isachardot}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymSum}ps{\isacharprime}{\isasymleftarrow}split{\isacharunderscore}sign{\isacharunderscore}changes\ ps\ x\isactrlsub {\isadigit{0}}{\isachardot}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sign{\isacharunderscore}changes{\isacharprime}\ x\isactrlsub {\isadigit{0}}\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ eventually{\isacharunderscore}mono{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ goal{\isadigit{1}}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}ps{\isacharunderscore}nz\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharbraceleft}p\ {\isasymin}\ set\ ps{\isachardot}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isasymforall}p{\isasymin}{\isacharquery}ps{\isacharunderscore}nz{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ eventually{\isacharunderscore}Ball{\isacharunderscore}finite{\isacharcomma}\ auto\ intro{\isacharcolon}\ poly{\isacharunderscore}neighbourhood{\isacharunderscore}same{\isacharunderscore}sign{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ {\isacharparenleft}{\isasymforall}p{\isasymin}{\isacharbraceleft}p\ {\isasymin}\ set\ ps{\isachardot}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbraceright}{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isasymlongrightarrow}\isanewline
\ \ \ \ \ \ \ \ sign{\isacharunderscore}changes{\isacharprime}\ x\isactrlsub {\isadigit{0}}\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}clarify{\isacharparenright}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ nbh{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}p{\isasymin}{\isacharquery}ps{\isacharunderscore}nz{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharprime}\ x\isactrlsub {\isadigit{0}}\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ x\isactrlsub {\isadigit{0}}\ rule{\isacharcolon}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{3}}\ p\ q\ r\ ps\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ IH\ {\isacharequal}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharcomma}{\isadigit{4}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{3}}\ \isacommand{interpret}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isachardoublequoteopen}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ signs{\isacharbrackleft}of\ {\isadigit{0}}{\isacharbrackright}\ \isakeyword{and}\ True\ \isacommand{have}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sgn{\isacharunderscore}r{\isacharunderscore}x{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isacharasterisk}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{3}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ nbh\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{5}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ r\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}zero{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}distrib{\isacharbrackleft}OF\ this{\isacharcomma}\ of\ {\isachardoublequoteopen}{\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}{\isachardoublequoteclose}\ ps{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ {\isacharparenleft}{\isacharbrackleft}p{\isacharcomma}\ q{\isacharcomma}\ r{\isacharbrackright}{\isacharparenright}\ x\ {\isacharplus}\ sign{\isacharunderscore}changes\ {\isacharparenleft}r\ {\isacharhash}\ ps{\isacharparenright}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}r{\isacharhash}ps{\isacharparenright}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes{\isacharprime}\ x\isactrlsub {\isadigit{0}}\ {\isacharparenleft}r{\isacharhash}ps{\isacharparenright}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isacharbackquoteclose}\ nbh\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{5}}{\isacharparenright}{\isacharbackquoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ IH{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharprime}{\isacharunderscore}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ True\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ nbh\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{5}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ q\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}zero{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}distrib{\isacharbrackleft}OF\ this{\isacharcomma}\ of\ {\isachardoublequoteopen}{\isacharbrackleft}p{\isacharbrackright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}r{\isacharhash}ps{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ {\isacharparenleft}{\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}{\isacharparenright}\ x\ {\isacharplus}\ sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes{\isacharprime}\ x\isactrlsub {\isadigit{0}}\ {\isacharparenleft}q{\isacharhash}r{\isacharhash}ps{\isacharparenright}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ nbh\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{5}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ IH{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharprime}{\isacharunderscore}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ False\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def\ sign{\isacharunderscore}changes{\isacharprime}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharparenright}\ hd{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const{\isacharunderscore}aux{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}hd\ ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}ps{\isacharprime}\ {\isasymin}\ set\ {\isacharparenleft}split{\isacharunderscore}sign{\isacharunderscore}changes\ ps\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ x\isactrlsub {\isadigit{0}}\ rule{\isacharcolon}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{1}}\ p\ x{\isacharparenright}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{2}}\ p\ q\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ps{\isacharprime}\ {\isacharequal}\ {\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{2}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{2}}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{interpret}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isachardoublequoteopen}{\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}neighbourhood{\isacharunderscore}same{\isacharunderscore}sign{\isacharbrackleft}OF\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ last{\isacharunderscore}ps{\isacharunderscore}sgn{\isacharunderscore}const\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ sgn{\isacharunderscore}q{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ q\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ \ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isasymforall}p{\isasymin}set{\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ intro{\isacharcolon}\ eventually{\isacharunderscore}mono{\isacharbrackleft}OF\ {\isacharunderscore}\ A{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ same{\isacharunderscore}signs{\isacharunderscore}imp{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharprime}{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{3}}\ p\ q\ r\ ps{\isacharprime}{\isacharprime}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ p{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ sturm\ {\isacharequal}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ IH\ {\isacharequal}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ ps{\isacharprime}{\isacharprime}{\isacharunderscore}props\ {\isacharequal}\ goal{\isadigit{3}}{\isacharparenleft}{\isadigit{6}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ q{\isacharunderscore}{\isadigit{0}}\ {\isacharequal}\ this\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sturm\ \isacommand{interpret}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isachardoublequoteopen}p{\isacharhash}q{\isacharhash}r{\isacharhash}ps{\isacharprime}{\isacharprime}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ signs{\isacharbrackleft}of\ {\isadigit{0}}{\isacharbrackright}\ \isakeyword{and}\ q{\isacharunderscore}{\isadigit{0}}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ signs{\isacharprime}{\isacharcolon}\ {\isachardoublequoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isacharasterisk}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ p{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}ps{\isacharprime}\ {\isasymin}\ set\ {\isacharparenleft}split{\isacharunderscore}sign{\isacharunderscore}changes\ {\isacharparenleft}r\ {\isacharhash}\ ps{\isacharprime}{\isacharprime}{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ IH{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharcomma}\ fact{\isacharcomma}\ fact{\isacharcomma}\ simp\ add{\isacharcolon}\ r{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}{\isacharcomma}\ fact{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ ps{\isacharprime}{\isacharprime}{\isacharunderscore}props\ p{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ q{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ ps{\isacharprime}{\isacharunderscore}props{\isacharcolon}\ {\isachardoublequoteopen}ps{\isacharprime}\ {\isacharequal}\ {\isacharbrackleft}p{\isacharcomma}q{\isacharcomma}r{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ signs{\isacharbrackleft}of\ {\isadigit{0}}{\isacharbrackright}\ \isakeyword{and}\ q{\isacharunderscore}{\isadigit{0}}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ sgn{\isacharunderscore}r{\isacharcolon}\ {\isachardoublequoteopen}poly\ r\ x\isactrlsub {\isadigit{0}}\ {\isacharasterisk}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ p{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ sgn{\isacharunderscore}r\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sgn\ {\isacharparenleft}poly\ r\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ r\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ eventually{\isacharunderscore}conj\ poly{\isacharunderscore}neighbourhood{\isacharunderscore}same{\isacharunderscore}sign{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp{\isacharunderscore}all\ add{\isacharcolon}\ r{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ eventually{\isacharunderscore}mono{\isacharbrackleft}OF\ {\isacharunderscore}\ A{\isacharbrackright}{\isacharcomma}\ clarify{\isacharcomma}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ subst\ ps{\isacharprime}{\isacharunderscore}props{\isacharcomma}\ subst\ sign{\isacharunderscore}changes{\isacharunderscore}sturm{\isacharunderscore}triple{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isakeyword{and}\ B{\isacharcolon}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ r\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ r\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ prod{\isacharunderscore}neg{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}a\ {\isacharparenleft}b{\isacharcolon}{\isacharcolon}real{\isacharparenright}{\isachardot}\ {\isasymlbrakk}a{\isachargreater}{\isadigit{0}}{\isacharsemicolon}\ b{\isachargreater}{\isadigit{0}}{\isacharsemicolon}\ a{\isacharasterisk}b{\isacharless}{\isadigit{0}}{\isasymrbrakk}\ {\isasymLongrightarrow}\ False{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}a\ {\isacharparenleft}b{\isacharcolon}{\isacharcolon}real{\isacharparenright}{\isachardot}\ {\isasymlbrakk}a{\isacharless}{\isadigit{0}}{\isacharsemicolon}\ b{\isacharless}{\isadigit{0}}{\isacharsemicolon}\ a{\isacharasterisk}b{\isacharless}{\isadigit{0}}{\isasymrbrakk}\ {\isasymLongrightarrow}\ False{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}drule\ mult{\isacharunderscore}pos{\isacharunderscore}pos{\isacharcomma}\ simp{\isacharcomma}\ simp{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ drule\ mult{\isacharunderscore}neg{\isacharunderscore}neg{\isacharcomma}\ simp{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ A\ \isakeyword{and}\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ simp{\isacharcolon}\ sgn{\isacharunderscore}zero{\isacharunderscore}iff{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ sgn{\isacharunderscore}r\ p{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ r{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ A\ B\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ r\ x\ {\isacharasterisk}\ poly\ p\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ r\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ sgn{\isacharunderscore}less\ sgn{\isacharunderscore}times{\isacharcomma}\ metis\ sgn{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}{\isadigit{0}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ sgn{\isacharunderscore}r\ \isacommand{show}\isamarkupfalse%
\ sgn{\isacharunderscore}r{\isacharprime}{\isacharcolon}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ r\ x{\isacharparenright}\ {\isacharequal}\ {\isacharminus}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sgn{\isacharunderscore}real{\isacharunderscore}def\ not{\isacharunderscore}le\ not{\isacharunderscore}less\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharcomma}\ intro\ conjI\ impI{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ prod{\isacharunderscore}neg{\isacharbrackleft}of\ {\isachardoublequoteopen}poly\ r\ x{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ p\ x{\isachardoublequoteclose}{\isacharbrackright}\ \isacommand{apply}\isamarkupfalse%
\ force{\isacharplus}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{1}}\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ ps{\isacharprime}{\isacharunderscore}props{\isacharcomma}\ subst\ sign{\isacharunderscore}changes{\isacharunderscore}sturm{\isacharunderscore}triple{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fact{\isacharcomma}\ metis\ A\ B\ sgn{\isacharunderscore}r{\isacharprime}{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ q{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ {\isacharequal}\ this\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}ps{\isacharprime}\ {\isasymin}\ set\ {\isacharparenleft}split{\isacharunderscore}sign{\isacharunderscore}changes\ {\isacharparenleft}q\ {\isacharhash}\ r\ {\isacharhash}\ ps{\isacharprime}{\isacharprime}{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ IH{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharcomma}\ fact{\isacharcomma}\ simp\ add{\isacharcolon}\ q{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}{\isacharcomma}\ fact{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ ps{\isacharprime}{\isacharprime}{\isacharunderscore}props\ \isakeyword{and}\ q{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ps{\isacharprime}\ {\isacharequal}\ {\isacharbrackleft}p{\isacharcomma}\ q{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}p{\isasymin}set\ ps{\isacharprime}{\isachardot}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ q{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ p{\isacharunderscore}not{\isacharunderscore}{\isadigit{0}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ eventually{\isacharunderscore}mono{\isacharcomma}\ clarify{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}p{\isasymin}set\ ps{\isacharprime}{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ same{\isacharunderscore}signs{\isacharunderscore}imp{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharprime}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isasymforall}p{\isasymin}set\ ps{\isacharprime}{\isachardot}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ p\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ intro{\isacharcolon}\ eventually{\isacharunderscore}Ball{\isacharunderscore}finite\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ poly{\isacharunderscore}neighbourhood{\isacharunderscore}same{\isacharunderscore}sign{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharparenright}\ hd{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}hd\ ps{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}pss\ {\isacharequal}\ {\isachardoublequoteopen}split{\isacharunderscore}sign{\isacharunderscore}changes\ ps\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}f\ {\isacharequal}\ {\isachardoublequoteopen}{\isasymlambda}pss\ x{\isachardot}\ {\isasymSum}ps{\isacharprime}{\isasymleftarrow}pss{\isachardot}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ pss\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}ps{\isacharprime}{\isachardot}\ ps{\isacharprime}{\isasymin}set\ pss\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isacharquery}f\ pss\ x\ {\isacharequal}\ {\isacharquery}f\ pss\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ pss{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ ps{\isacharprime}\ pss{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ {\isacharquery}f\ pss\ x\ {\isacharequal}\ {\isacharquery}f\ pss\ x\isactrlsub {\isadigit{0}}\ {\isasymand}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\isactrlsub {\isadigit{0}}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ {\isacharquery}f\ {\isacharparenleft}ps{\isacharprime}{\isacharhash}pss{\isacharparenright}\ x\ {\isacharequal}\ {\isacharquery}f\ {\isacharparenleft}ps{\isacharprime}{\isacharhash}pss{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ A\ {\isacharequal}\ eventually{\isacharunderscore}mono{\isacharbrackleft}OF\ this\ eventually{\isacharunderscore}conj{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ A{\isacharcomma}\ simp{\isacharunderscore}all\ add{\isacharcolon}\ Cons{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ A\ {\isacharequal}\ this{\isacharbrackleft}of\ {\isacharquery}pss{\isacharbrackright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ B{\isacharcolon}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isacharquery}f\ {\isacharquery}pss\ x\ {\isacharequal}\ {\isacharquery}f\ {\isacharquery}pss\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ A{\isacharcomma}\ rule\ hd{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const{\isacharunderscore}aux{\isacharbrackleft}OF\ assms{\isacharbrackright}{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ C\ {\isacharequal}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}correct{\isacharunderscore}nbh{\isacharbrackleft}OF\ assms{\isacharbrackright}\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ D\ {\isacharequal}\ split{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}correct{\isacharbrackleft}OF\ assms{\isacharbrackright}\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ E\ {\isacharequal}\ eventually{\isacharunderscore}conj{\isacharbrackleft}OF\ B\ C{\isacharbrackright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ eventually{\isacharunderscore}mono{\isacharbrackleft}OF\ {\isacharunderscore}\ E{\isacharbrackright}{\isacharcomma}\ auto\ simp{\isacharcolon}\ D{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{hide{\isacharunderscore}fact}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isachardot}hd{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const{\isacharunderscore}aux%
\begin{isamarkuptext}%
If x is not a root of p, the number of sign changes of the sequence 
  remains constant in the neighbourhood of x.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ sturm{\isacharunderscore}seq{\isacharparenright}\ p{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ \isanewline
\ \ \ \ \ \ \ eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
If \isa{x} is a root of \isa{p} and \isa{p} is not the 
  zero polynomial, the number of sign changes decreases by 1 at 
  \isa{x}.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharparenright}\ p{\isacharunderscore}zero{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ sign{\isacharunderscore}changes\ ps\ x\isactrlsub {\isadigit{0}}\ {\isacharplus}\ {\isacharparenleft}if\ x{\isacharless}x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ ps{\isacharunderscore}first{\isacharunderscore}two\ \isacommand{obtain}\isamarkupfalse%
\ q\ ps{\isacharprime}\ \isakeyword{where}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ps\ {\isacharequal}\ p{\isacharhash}q{\isacharhash}ps{\isacharprime}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}ps{\isacharbang}{\isadigit{1}}\ {\isacharequal}\ q{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ eventually{\isacharunderscore}at{\isacharcomma}\ rule\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ {\isadigit{1}}{\isacharbrackright}{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ p{\isacharunderscore}squarefree\ \isakeyword{and}\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ ps{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq{\isacharunderscore}Cons{\isacharbrackleft}of\ p\ {\isachardoublequoteopen}q{\isacharhash}ps{\isacharprime}{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ quasi{\isacharunderscore}sturm{\isacharunderscore}seq\ {\isachardoublequoteopen}q{\isacharhash}ps{\isacharprime}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacharbackquoteopen}poly\ q\ x\isactrlsub {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}ps{\isacharprime}{\isacharparenright}\ x\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}ps{\isacharprime}{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const{\isacharbrackleft}\isakeyword{where}\ x\isactrlsub {\isadigit{0}}{\isacharequal}x\isactrlsub {\isadigit{0}}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \ \ \isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ poly{\isacharunderscore}neighbourhood{\isacharunderscore}without{\isacharunderscore}roots{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackright}\ deriv{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ x\isactrlsub {\isadigit{0}}\ {\isasymand}\ poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p{\isacharasterisk}ps{\isacharbang}{\isadigit{1}}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}ps{\isacharprime}{\isacharparenright}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}ps{\isacharprime}{\isacharparenright}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ only{\isacharcolon}\ {\isacharbackquoteopen}ps{\isacharbang}{\isadigit{1}}\ {\isacharequal}\ q{\isacharbackquoteclose}{\isacharcomma}\ intro\ eventually{\isacharunderscore}conj{\isacharparenright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ eventually{\isacharunderscore}mono{\isacharbrackleft}OF\ {\isacharunderscore}\ A{\isacharbrackright}{\isacharcomma}\ clarify{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{1}}\ x{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ zero{\isacharunderscore}less{\isacharunderscore}mult{\isacharunderscore}pos\ \isacommand{have}\isamarkupfalse%
\ zero{\isacharunderscore}less{\isacharunderscore}mult{\isacharunderscore}pos{\isacharprime}{\isacharcolon}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}a\ b{\isachardot}\ {\isasymlbrakk}{\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}real{\isacharparenright}\ {\isacharless}\ a{\isacharasterisk}b{\isacharsemicolon}\ {\isadigit{0}}\ {\isacharless}\ b{\isasymrbrakk}\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subgoal{\isacharunderscore}tac\ {\isachardoublequoteopen}a{\isacharasterisk}b\ {\isacharequal}\ b{\isacharasterisk}a{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{1}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ q\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ q{\isacharunderscore}sgn{\isacharcolon}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x\ {\isacharless}\ x\isactrlsub {\isadigit{0}}\ then\ {\isacharminus}sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ else\ sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ sgn{\isacharunderscore}real{\isacharunderscore}def\ elim{\isacharcolon}\ linorder{\isacharunderscore}neqE{\isacharunderscore}linordered{\isacharunderscore}idom\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dest{\isacharcolon}\ mult{\isacharunderscore}pos{\isacharunderscore}pos\ mult{\isacharunderscore}neg{\isacharunderscore}neg\ zero{\isacharunderscore}less{\isacharunderscore}mult{\isacharunderscore}pos\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ zero{\isacharunderscore}less{\isacharunderscore}mult{\isacharunderscore}pos{\isacharprime}\ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}distrib{\isacharbrackleft}OF\ {\isacharbackquoteopen}poly\ q\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharcomma}\ of\ {\isachardoublequoteopen}{\isacharbrackleft}p{\isacharbrackright}{\isachardoublequoteclose}\ ps{\isacharprime}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ {\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}\ x\ {\isacharplus}\ sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}ps{\isacharprime}{\isacharparenright}\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ q{\isacharunderscore}sgn\ \isakeyword{and}\ {\isacharbackquoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}\ x\ {\isacharequal}\ {\isacharparenleft}if\ x{\isacharless}x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def\ sgn{\isacharunderscore}zero{\isacharunderscore}iff\ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{4}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ {\isacharparenleft}q{\isacharhash}ps{\isacharprime}{\isacharparenright}\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\ \ \ \ \isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharunderscore}aux{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}a\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymforall}x{\isacharcolon}{\isacharcolon}real{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymlongrightarrow}\ eventually\ {\isacharparenleft}{\isasymlambda}{\isasymxi}{\isachardot}\ f\ {\isasymxi}\ {\isacharequal}\ {\isacharparenleft}f\ x{\isacharcolon}{\isacharcolon}nat{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymlongrightarrow}\ f\ x\ {\isacharequal}\ f\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}clarify{\isacharparenright}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isachargreater}\ a{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isacharprime}{\isachardot}\ x\ {\isasymle}\ x{\isacharprime}\ {\isasymand}\ x{\isacharprime}\ {\isasymle}\ b\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eventually\ {\isacharparenleft}{\isasymlambda}{\isasymxi}{\isachardot}\ f\ {\isasymxi}\ {\isacharequal}\ f\ x{\isacharprime}{\isacharparenright}\ {\isacharparenleft}at\ x{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ natfun{\isacharunderscore}eq{\isacharunderscore}in{\isacharunderscore}ivl{\isacharbrackleft}OF\ {\isacharbackquoteopen}x\ {\isasymle}\ b{\isacharbackquoteclose}\ this{\isacharbrackright}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ x\ {\isacharequal}\ f\ b{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
If \isa{p} is non-constant, the number of roots in an interval can 
  be computed by the number of sign changes of the sequence at 
  the border of the interval.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharparenright}\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}a\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ b\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ int\ {\isacharparenleft}sign{\isacharunderscore}changes\ ps\ b{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}a\ {\isasymle}\ b{\isacharbackquoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ {\isachardoublequoteopen}card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ arbitrary{\isacharcolon}\ a\ b\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ rule{\isacharcolon}\ less{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}less\ a\ b{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}{\isasymexists}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ no{\isacharunderscore}roots{\isacharcolon}\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}roots{\isacharequal}{\isacharunderscore}{\isachardoublequoteclose}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ card{\isacharunderscore}roots{\isacharcolon}\ {\isachardoublequoteopen}card\ {\isacharquery}roots\ {\isacharequal}\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}int{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ no{\isacharunderscore}roots{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}simp\ only{\isacharcolon}\ card{\isacharunderscore}roots\ eq{\isacharunderscore}iff{\isacharunderscore}diff{\isacharunderscore}eq{\isacharunderscore}{\isadigit{0}}{\isacharbrackleft}symmetric{\isacharbrackright}\ int{\isacharunderscore}int{\isacharunderscore}eq{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cases\ {\isachardoublequoteopen}poly\ p\ a\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ no{\isacharunderscore}roots\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ a\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ intro{\isacharcolon}\ natfun{\isacharunderscore}eq{\isacharunderscore}in{\isacharunderscore}ivl\ {\isacharbackquoteopen}a\ {\isasymle}\ b{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ p{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymlongrightarrow}\ sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharunderscore}aux{\isacharcomma}\ fact{\isacharcomma}\ clarify{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ p{\isacharunderscore}nonzero{\isacharunderscore}imp{\isacharunderscore}sign{\isacharunderscore}changes{\isacharunderscore}const{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}insert\ False{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ a{\isacharparenright}\ {\isacharparenleft}at\ a{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ eventually{\isacharunderscore}mono{\isacharparenright}\ \isacommand{defer}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ p{\isacharunderscore}zero{\isacharbrackleft}OF\ {\isacharbackquoteopen}poly\ p\ a\ {\isacharequal}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}{\isacharcomma}\ force{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{done}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ {\isasymdelta}\ \isakeyword{where}\ {\isasymdelta}{\isacharunderscore}props{\isacharcolon}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymdelta}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isacharless}\ a{\isacharplus}{\isasymdelta}\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ eventually{\isacharunderscore}at\ dist{\isacharunderscore}real{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ a\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isacharequal}\ b{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{def}\isamarkupfalse%
\ x\ {\isasymequiv}\ {\isachardoublequoteopen}min\ {\isacharparenleft}a{\isacharplus}{\isasymdelta}{\isacharslash}{\isadigit{2}}{\isacharparenright}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ False\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isacharless}\ x{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isacharless}\ a{\isacharplus}{\isasymdelta}{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymle}\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymdelta}\ {\isachargreater}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}a\ {\isasymle}\ b{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isasymdelta}{\isacharunderscore}props\ {\isacharbackquoteopen}a\ {\isacharless}\ x{\isacharbackquoteclose}\ {\isacharbackquoteopen}x\ {\isacharless}\ a{\isacharplus}{\isasymdelta}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ a\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ A\ {\isacharbackquoteopen}a\ {\isacharless}\ x{\isacharbackquoteclose}\ {\isacharbackquoteopen}x\ {\isasymle}\ b{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ b{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}roots{\isacharunderscore}finite{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ fin{\isacharcolon}\ {\isachardoublequoteopen}finite\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ intro{\isacharcolon}\ finite{\isacharunderscore}subset{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ True\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ fin\ \isacommand{have}\isamarkupfalse%
\ card{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{def}\isamarkupfalse%
\ x\ {\isasymequiv}\ {\isachardoublequoteopen}Min\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ Min{\isacharunderscore}in{\isacharbrackleft}OF\ fin{\isacharbrackright}\ \isakeyword{and}\ True\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}props{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isachargreater}\ a{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymle}\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ x{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast{\isacharplus}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ Min{\isacharunderscore}le{\isacharbrackleft}OF\ fin{\isacharbrackright}\ x{\isacharunderscore}props\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ x{\isacharunderscore}le{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}x{\isacharprime}{\isachardot}\ {\isasymlbrakk}x{\isacharprime}\ {\isachargreater}\ a{\isacharsemicolon}\ x{\isacharprime}\ {\isasymle}\ b{\isacharsemicolon}\ poly\ p\ x{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isasymrbrakk}\ {\isasymLongrightarrow}\ x\ {\isasymle}\ x{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ x{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ left{\isacharcolon}\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isacharprime}{\isachardot}\ a\ {\isacharless}\ x{\isacharprime}\ {\isasymand}\ x{\isacharprime}\ {\isasymle}\ x\ {\isasymand}\ poly\ p\ x{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}x{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}props\ x{\isacharunderscore}le\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}card\ {\isacharbraceleft}x{\isacharprime}{\isachardot}\ a\ {\isacharless}\ x{\isacharprime}\ {\isasymand}\ x{\isacharprime}\ {\isasymle}\ x\ {\isasymand}\ poly\ p\ x{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ p{\isacharunderscore}zero{\isacharbrackleft}OF\ {\isacharbackquoteopen}poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ unfolded\ eventually{\isacharunderscore}at\ dist{\isacharunderscore}real{\isacharunderscore}def{\isacharbrackright}\ \isacommand{guess}\isamarkupfalse%
\ {\isasymepsilon}\ \isacommand{{\isachardot}{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isasymepsilon}{\isacharunderscore}props{\isacharcolon}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymforall}x{\isacharprime}{\isachardot}\ x{\isacharprime}\ {\isasymnoteq}\ x\ {\isasymand}\ {\isasymbar}x{\isacharprime}\ {\isacharminus}\ x{\isasymbar}\ {\isacharless}\ {\isasymepsilon}\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ ps\ x{\isacharprime}\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x\ {\isacharplus}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x{\isacharprime}\ {\isacharless}\ x\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{def}\isamarkupfalse%
\ x{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}max\ {\isacharparenleft}x\ {\isacharminus}\ {\isasymepsilon}\ {\isacharslash}\ {\isadigit{2}}{\isacharparenright}\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymbar}x{\isacharprime}\ {\isacharminus}\ x{\isasymbar}\ {\isacharless}\ {\isasymepsilon}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymepsilon}\ {\isachargreater}\ {\isadigit{0}}{\isacharbackquoteclose}\ x{\isacharunderscore}props\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ x{\isacharprime}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ x{\isacharprime}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x{\isacharprime}\ {\isacharless}\ x\ then\ sign{\isacharunderscore}changes\ ps\ x\ {\isacharplus}\ {\isadigit{1}}\ else\ sign{\isacharunderscore}changes\ ps\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymepsilon}{\isacharunderscore}props{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}x{\isacharprime}\ {\isacharequal}\ x{\isachardoublequoteclose}{\isacharcomma}\ simp{\isacharcomma}\ force{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ x{\isacharprime}\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ x\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ x{\isacharprime}{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}props\ {\isacharbackquoteopen}{\isasymepsilon}\ {\isachargreater}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymnotin}\ {\isacharbraceleft}x{\isacharprime}{\isacharprime}{\isachardot}\ a\ {\isacharless}\ x{\isacharprime}{\isacharprime}\ {\isasymand}\ x{\isacharprime}{\isacharprime}\ {\isasymle}\ x{\isacharprime}\ {\isasymand}\ poly\ p\ x{\isacharprime}{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ x{\isacharprime}{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymepsilon}\ {\isachargreater}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ left\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isacharprime}{\isacharprime}{\isachardot}\ a\ {\isacharless}\ x{\isacharprime}{\isacharprime}\ {\isasymand}\ x{\isacharprime}{\isacharprime}\ {\isasymle}\ x{\isacharprime}\ {\isasymand}\ poly\ p\ x{\isacharprime}{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ less{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}of\ a\ x{\isacharprime}{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ x{\isacharprime}\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ x{\isacharprime}{\isacharunderscore}def\ {\isacharbackquoteopen}{\isasymepsilon}\ {\isachargreater}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ simp{\isacharcolon}\ card{\isacharunderscore}greater{\isacharunderscore}{\isadigit{0}}{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ signs{\isacharunderscore}left{\isacharcolon}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ int\ {\isacharparenleft}sign{\isacharunderscore}changes\ ps\ x{\isacharparenright}\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}x{\isacharprime}{\isachardot}\ a\ {\isacharless}\ x{\isacharprime}\ {\isasymand}\ x{\isacharprime}\ {\isasymle}\ x\ {\isasymand}\ poly\ p\ x{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}x{\isacharprime}{\isachardot}\ x\ {\isacharless}\ x{\isacharprime}\ {\isasymand}\ x{\isacharprime}\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}props\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ left\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}card\ {\isacharbraceleft}x{\isacharprime}{\isachardot}\ x\ {\isacharless}\ x{\isacharprime}\ {\isasymand}\ x{\isacharprime}\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ fin\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharbraceleft}x{\isacharprime}{\isachardot}\ x\ {\isacharless}\ x{\isacharprime}\ {\isasymand}\ x{\isacharprime}\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharless}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ less{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ this\ x{\isacharunderscore}props{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackright}\ \isakeyword{and}\ A\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ signs{\isacharunderscore}right{\isacharcolon}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ x\ {\isacharminus}\ int\ {\isacharparenleft}sign{\isacharunderscore}changes\ ps\ b{\isacharparenright}\ {\isacharplus}\ {\isadigit{1}}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}x{\isacharprime}{\isachardot}\ x{\isacharprime}\ {\isachargreater}\ a\ {\isasymand}\ x{\isacharprime}\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ signs{\isacharunderscore}left\ \isakeyword{and}\ signs{\isacharunderscore}right\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The number of sign changes in the limits of the polynomials to 
  positive (resp. negative) infinity can be used to compute the 
  number of roots above or below a certain number, or the total number.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharparenright}\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymin}\ set\ ps{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}in{\isacharunderscore}set{\isacharbrackleft}OF\ ps{\isacharunderscore}not{\isacharunderscore}Nil{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}set\ ps{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ polys{\isacharunderscore}inf{\isacharunderscore}sign{\isacharunderscore}thresholds{\isacharbrackleft}OF\ this{\isacharbrackright}\ \isacommand{guess}\isamarkupfalse%
\ l\ u\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ lu{\isacharunderscore}props\ {\isacharequal}\ this\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}u\ {\isacharequal}\ {\isachardoublequoteopen}max\ a\ u{\isachardoublequoteclose}\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymle}\ {\isacharquery}u{\isachardoublequoteclose}\isanewline
\ \ \ \isacommand{using}\isamarkupfalse%
\ lu{\isacharunderscore}props{\isacharparenleft}{\isadigit{3}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymin}\ set\ ps{\isacharbackquoteclose}{\isacharcomma}\ of\ x{\isacharbrackright}\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}u\ {\isasymle}\ x{\isachardoublequoteclose}{\isacharcomma}\ auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}zero{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharequal}\ this\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ lu{\isacharunderscore}props\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ {\isacharquery}u{\isacharparenright}{\isacharparenright}\ ps\ {\isacharequal}\ map\ poly{\isacharunderscore}inf\ ps{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ {\isacharquery}u{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ only{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def\ sign{\isacharunderscore}changes{\isacharunderscore}inf{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharbrackleft}OF\ assms{\isacharbrackright}\ lu{\isacharunderscore}props\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ \ card\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ {\isacharquery}u\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ {\isacharquery}u\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ lu{\isacharunderscore}props\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharparenright}\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ a\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymin}\ set\ ps{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}in{\isacharunderscore}set{\isacharbrackleft}OF\ ps{\isacharunderscore}not{\isacharunderscore}Nil{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}set\ ps{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ polys{\isacharunderscore}inf{\isacharunderscore}sign{\isacharunderscore}thresholds{\isacharbrackleft}OF\ this{\isacharbrackright}\ \isacommand{guess}\isamarkupfalse%
\ l\ u\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ lu{\isacharunderscore}props\ {\isacharequal}\ this\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}l\ {\isacharequal}\ {\isachardoublequoteopen}min\ a\ l{\isachardoublequoteclose}\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isachargreater}\ {\isacharquery}l{\isachardoublequoteclose}\isanewline
\ \ \ \isacommand{using}\isamarkupfalse%
\ lu{\isacharunderscore}props{\isacharparenleft}{\isadigit{4}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymin}\ set\ ps{\isacharbackquoteclose}{\isacharcomma}\ of\ x{\isacharbrackright}\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}l\ {\isacharless}\ x{\isachardoublequoteclose}{\isacharcomma}\ auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}zero{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}\ {\isacharequal}\ this\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ lu{\isacharunderscore}props\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ {\isacharquery}l{\isacharparenright}{\isacharparenright}\ ps\ {\isacharequal}\ map\ poly{\isacharunderscore}neg{\isacharunderscore}inf\ ps{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ a\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ ps\ {\isacharquery}l\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ a{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ only{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharbrackleft}OF\ assms{\isacharbrackright}\ lu{\isacharunderscore}props\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ \ card\ {\isacharbraceleft}x{\isachardot}\ {\isacharquery}l\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ {\isacharquery}l\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}x{\isachardot}\ a\ {\isasymge}\ x\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ lu{\isacharunderscore}props\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharparenright}\ count{\isacharunderscore}roots{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ card\ {\isacharbraceleft}x{\isachardot}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}set\ ps{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ polys{\isacharunderscore}inf{\isacharunderscore}sign{\isacharunderscore}thresholds{\isacharbrackleft}OF\ this{\isacharbrackright}\ \isacommand{guess}\isamarkupfalse%
\ l\ u\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ lu{\isacharunderscore}props\ {\isacharequal}\ this\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ lu{\isacharunderscore}props\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ l{\isacharparenright}{\isacharparenright}\ ps\ {\isacharequal}\ map\ poly{\isacharunderscore}neg{\isacharunderscore}inf\ ps{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ sgn\ {\isacharparenleft}poly\ p\ u{\isacharparenright}{\isacharparenright}\ ps\ {\isacharequal}\ map\ poly{\isacharunderscore}inf\ ps{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ ps\ l\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ only{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def\ sign{\isacharunderscore}changes{\isacharunderscore}inf{\isacharunderscore}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharbrackleft}OF\ assms{\isacharbrackright}\ lu{\isacharunderscore}props\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ \ card\ {\isacharbraceleft}x{\isachardot}\ l\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ u\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ l\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ u\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}x{\isachardot}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ lu{\isacharunderscore}props\ assms\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsection{Canonical Sturm sequence%
}
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ degree{\isacharunderscore}mod{\isacharunderscore}less{\isacharprime}{\isacharcolon}\ {\isachardoublequoteopen}degree\ q\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ degree\ {\isacharparenleft}p\ mod\ q{\isacharparenright}\ {\isacharless}\ degree\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ degree{\isacharunderscore}mod{\isacharunderscore}less\ \isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{function}\isamarkupfalse%
\ sturm{\isacharunderscore}aux\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}sturm{\isacharunderscore}aux\ {\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}\ q\ {\isacharequal}\ \isanewline
\ \ \ \ {\isacharparenleft}if\ degree\ q\ {\isacharequal}\ {\isadigit{0}}\ then\ {\isacharbrackleft}p{\isacharcomma}q{\isacharbrackright}\ else\ p\ {\isacharhash}\ sturm{\isacharunderscore}aux\ q\ {\isacharparenleft}{\isacharminus}{\isacharparenleft}p\ mod\ q{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}pat{\isacharunderscore}completeness{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{termination}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}relation\ {\isachardoublequoteopen}measure\ {\isacharparenleft}degree\ {\isasymcirc}\ snd{\isacharparenright}{\isachardoublequoteclose}{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ simp{\isacharunderscore}all\ add{\isacharcolon}\ o{\isacharunderscore}def\ degree{\isacharunderscore}mod{\isacharunderscore}less{\isacharprime}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{declare}\isamarkupfalse%
\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharbrackleft}simp\ del{\isacharbrackright}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ sturm\ \isakeyword{where}\ {\isachardoublequoteopen}sturm\ p\ {\isacharequal}\ sturm{\isacharunderscore}aux\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}{\isadigit{0}}{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm\ {\isadigit{0}}\ {\isacharequal}\ {\isacharbrackleft}{\isadigit{0}}{\isacharcomma}{\isadigit{0}}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}unfold\ sturm{\isacharunderscore}def{\isacharcomma}\ subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm{\isacharunderscore}aux\ p\ q\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymlongleftrightarrow}\ False{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ p\ q\ rule{\isacharcolon}\ sturm{\isacharunderscore}aux{\isachardot}induct{\isacharcomma}\ subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}neq{\isacharunderscore}Nil{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm\ p\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}hd\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isacharequal}\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ {\isasymin}\ set\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ hd{\isacharunderscore}in{\isacharunderscore}set{\isacharbrackleft}OF\ sturm{\isacharunderscore}neq{\isacharunderscore}Nil{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}length\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isacommand{fix}\isamarkupfalse%
\ q\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}sturm{\isacharunderscore}aux\ p\ q{\isacharparenright}\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ p\ q\ rule{\isacharcolon}\ sturm{\isacharunderscore}aux{\isachardot}induct{\isacharcomma}\ subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}degree\ {\isacharparenleft}last\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isacommand{fix}\isamarkupfalse%
\ q\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}degree\ {\isacharparenleft}last\ {\isacharparenleft}sturm{\isacharunderscore}aux\ p\ q{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ p\ q\ rule{\isacharcolon}\ sturm{\isacharunderscore}aux{\isachardot}induct{\isacharcomma}\ subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm{\isacharunderscore}aux\ p\ q\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm{\isacharunderscore}aux\ p\ q\ {\isacharbang}\ Suc\ {\isadigit{0}}\ {\isacharequal}\ q{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ p{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ Suc\ {\isadigit{0}}\ {\isacharequal}\ pderiv\ p{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}indices{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isacharminus}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sturm\ p{\isacharbang}{\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isacharminus}{\isacharparenleft}sturm\ p{\isacharbang}i\ mod\ sturm\ p{\isacharbang}{\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isacommand{fix}\isamarkupfalse%
\ ps\ q\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymlbrakk}ps\ {\isacharequal}\ sturm{\isacharunderscore}aux\ p\ q{\isacharsemicolon}\ i\ {\isacharless}\ length\ ps\ {\isacharminus}\ {\isadigit{2}}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ ps{\isacharbang}{\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isacharminus}{\isacharparenleft}ps{\isacharbang}i\ mod\ ps{\isacharbang}{\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ p\ q\ arbitrary{\isacharcolon}\ ps\ i\ rule{\isacharcolon}\ sturm{\isacharunderscore}aux{\isachardot}induct{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{1}}\ p\ q{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}i\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ i{\isacharprime}\ \isakeyword{where}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}i\ {\isacharequal}\ Suc\ i{\isacharprime}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ i{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ ps\ {\isasymge}\ {\isadigit{4}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ goal{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ deg{\isacharcolon}\ {\isachardoublequoteopen}degree\ q\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}asm{\isacharparenright}\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp\ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{obtain}\isamarkupfalse%
\ ps{\isacharprime}\ \isakeyword{where}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}ps\ {\isacharequal}\ p\ {\isacharhash}\ ps{\isacharprime}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}asm{\isacharparenright}\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ deg\ \isacommand{have}\isamarkupfalse%
\ ps{\isacharprime}{\isacharcolon}\ {\isachardoublequoteopen}ps{\isacharprime}\ {\isacharequal}\ sturm{\isacharunderscore}aux\ q\ {\isacharparenleft}{\isacharminus}{\isacharparenleft}p\ mod\ q{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}asm{\isacharparenright}\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacharbackquoteopen}length\ ps\ {\isasymge}\ {\isadigit{4}}{\isacharbackquoteclose}\ \isakeyword{and}\ {\isacharbackquoteopen}ps\ {\isacharequal}\ p\ {\isacharhash}\ ps{\isacharprime}{\isacharbackquoteclose}goal{\isadigit{1}}{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharminus}\ {\isadigit{1}}\ {\isacharless}\ length\ ps{\isacharprime}\ {\isacharminus}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ deg\ ps{\isacharprime}\ this{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ ps\ {\isasymge}\ {\isadigit{3}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}degree\ q\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}asm{\isacharparenright}\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp\ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm{\isacharunderscore}aux\ p\ q\ {\isacharbang}\ Suc\ {\isacharparenleft}Suc\ {\isadigit{0}}{\isacharparenright}\ {\isacharequal}\ {\isacharminus}{\isacharparenleft}p\ mod\ q{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ True\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}ps{\isacharbang}i\ {\isacharequal}\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}ps{\isacharbang}{\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ q{\isachardoublequoteclose}\ {\isachardoublequoteopen}ps{\isacharbang}{\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isacharminus}{\isacharparenleft}p\ mod\ q{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ this{\isacharbrackleft}OF\ sturm{\isacharunderscore}def\ assms{\isacharbrackright}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}aux{\isacharunderscore}gcd{\isacharcolon}\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ {\isacharparenleft}sturm{\isacharunderscore}aux\ p\ q{\isacharparenright}\ {\isasymLongrightarrow}\ gcd\ p\ q\ dvd\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ p\ q\ rule{\isacharcolon}\ sturm{\isacharunderscore}aux{\isachardot}induct{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{1}}\ p\ q{\isacharparenright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}r\ {\isacharequal}\ p{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ r{\isacharcolon}\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ {\isacharparenleft}sturm{\isacharunderscore}aux\ q\ {\isacharparenleft}{\isacharminus}{\isacharparenleft}p\ mod\ q{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}asm{\isacharparenright}\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp\ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharcomma}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}degree\ q\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ False\ r{\isacharbrackright}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ gcd{\isacharunderscore}poly{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}q\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isakeyword{and}\ {\isacharbackquoteopen}r\ {\isasymnoteq}\ p{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isacharequal}\ q{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}asm{\isacharparenright}\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}gcd{\isacharcolon}\ {\isachardoublequoteopen}r\ {\isasymin}\ set\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isasymLongrightarrow}\ gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ dvd\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ \ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ sturm{\isacharunderscore}aux{\isacharunderscore}gcd{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}propagate{\isacharunderscore}left{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm\ {\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}j{\isasymle}i{\isacharplus}{\isadigit{1}}{\isachardot}\ poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ j{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}intro\ sturm{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}aux{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{1}}{\isacharcomma}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharparenright}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{1}}\ i\ x{\isacharparenright}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}p\ {\isacharequal}\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}q\ {\isacharequal}\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}r\ {\isacharequal}\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}indices{\isacharbrackleft}OF\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}p\ {\isacharequal}\ {\isacharquery}p\ div\ {\isacharquery}q\ {\isacharasterisk}\ {\isacharquery}q\ {\isacharminus}\ {\isacharquery}r{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ mod{\isacharunderscore}div{\isacharunderscore}equality{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharquery}p\ x\ {\isacharequal}\ poly\ {\isacharparenleft}{\isacharquery}p\ div\ {\isacharquery}q\ {\isacharasterisk}\ {\isacharquery}q\ {\isacharminus}\ {\isacharquery}r{\isacharparenright}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharquery}p\ x\ {\isacharequal}\ {\isacharminus}poly\ {\isacharquery}r\ x{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sgn{\isacharunderscore}minus{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}not{\isacharunderscore}squarefree{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm\ {\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymnot}rsquarefree\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}propagate{\isacharunderscore}left{\isacharbrackleft}OF\ assms{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ rsquarefree{\isacharunderscore}roots{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}firsttwo{\isacharunderscore}signs{\isacharunderscore}aux{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}q\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ q{\isacharunderscore}pderiv{\isacharcolon}\ \isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ x{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ p{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ {\isacharparenleft}x\isactrlsub {\isadigit{0}}{\isacharcolon}{\isacharcolon}real{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p{\isacharasterisk}q{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ poly\ q\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ x{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \ {\isacharbackquoteopen}q\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ poly{\isacharunderscore}neighbourhood{\isacharunderscore}same{\isacharunderscore}sign\ q{\isacharunderscore}pderiv\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ poly{\isacharunderscore}neighbourhood{\isacharunderscore}without{\isacharunderscore}roots\ eventually{\isacharunderscore}conj{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ {\isasymepsilon}\ \isakeyword{where}\ {\isasymepsilon}{\isacharunderscore}props{\isacharcolon}\ {\isachardoublequoteopen}{\isasymepsilon}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}\ x\ {\isasymnoteq}\ x\isactrlsub {\isadigit{0}}\ {\isasymand}\ {\isasymbar}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isasymbar}\ {\isacharless}\ {\isasymepsilon}\ {\isasymlongrightarrow}\ \isanewline
\ \ \ \ \ \ poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ poly\ q\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ eventually{\isacharunderscore}at\ dist{\isacharunderscore}real{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ sqr{\isacharunderscore}pos{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}x{\isacharcolon}{\isacharcolon}real{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ sgn\ x\ {\isacharasterisk}\ sgn\ x\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}real{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}simp\ only{\isacharcolon}\ eventually{\isacharunderscore}at\ dist{\isacharunderscore}real{\isacharunderscore}def{\isacharcomma}\ rule\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ {\isasymepsilon}{\isacharbrackright}{\isacharcomma}\isanewline
\ \ \ \ \ \ \ \ \ intro\ conjI{\isacharcomma}\ fact\ {\isacharbackquoteopen}{\isasymepsilon}\ {\isachargreater}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharcomma}\ clarify{\isacharparenright}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymnoteq}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymbar}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isasymbar}\ {\isacharless}\ {\isasymepsilon}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isasymepsilon}{\isacharunderscore}props\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ q\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p{\isacharasterisk}q{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}x\ {\isasymge}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacharbackquoteopen}x\ {\isasymnoteq}\ x\isactrlsub {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}MVT{\isacharbrackleft}OF\ this{\isacharcomma}\ of\ p{\isacharbrackright}\ \isacommand{guess}\isamarkupfalse%
\ {\isasymxi}\ \isacommand{{\isachardot}{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ {\isasymxi}{\isacharunderscore}props\ {\isacharequal}\ this\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymbar}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isasymbar}\ {\isacharless}\ {\isasymepsilon}{\isacharbackquoteclose}\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}{\isacharbackquoteclose}\ {\isasymepsilon}{\isacharunderscore}props\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymbar}{\isasymxi}\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isasymbar}\ {\isacharless}\ {\isasymepsilon}{\isachardoublequoteclose}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharasterisk}\ sgn\ {\isacharparenleft}poly\ q\ {\isasymxi}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ q{\isacharunderscore}pderiv\ sgn{\isacharunderscore}mult{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isasymxi}{\isacharunderscore}props\ {\isasymepsilon}{\isacharunderscore}props\ {\isacharbackquoteopen}{\isasymbar}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isasymbar}\ {\isacharless}\ {\isasymepsilon}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}t{\isachardot}\ {\isasymxi}\ {\isasymle}\ t\ {\isasymand}\ t\ {\isasymle}\ x\ {\isasymlongrightarrow}\ poly\ q\ t\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ q\ {\isasymxi}{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isasymxi}{\isacharunderscore}props\ {\isasymepsilon}{\isacharunderscore}props\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ no{\isacharunderscore}roots{\isacharunderscore}inbetween{\isacharunderscore}imp{\isacharunderscore}same{\isacharunderscore}sign{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ True\ {\isacharbackquoteopen}x\ {\isasymnoteq}\ x\isactrlsub {\isadigit{0}}{\isacharbackquoteclose}\ {\isasymepsilon}{\isacharunderscore}props\ {\isasymxi}{\isacharunderscore}props\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}mult\ sqr{\isacharunderscore}pos{\isacharparenright}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharless}\ x\isactrlsub {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ sgn{\isacharcolon}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharequal}\ {\isacharminus}{\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}MVT{\isacharbrackleft}OF\ {\isacharbackquoteopen}x\ {\isacharless}\ x\isactrlsub {\isadigit{0}}{\isacharbackquoteclose}{\isacharcomma}\ of\ p{\isacharbrackright}\ \isacommand{guess}\isamarkupfalse%
\ {\isasymxi}\ \isacommand{{\isachardot}{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ {\isasymxi}{\isacharunderscore}props\ {\isacharequal}\ this\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacharbackquoteopen}{\isasymbar}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isasymbar}\ {\isacharless}\ {\isasymepsilon}{\isacharbackquoteclose}\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}x\ {\isacharless}\ x\isactrlsub {\isadigit{0}}{\isacharbackquoteclose}\ {\isasymepsilon}{\isacharunderscore}props\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymbar}{\isasymxi}\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isasymbar}\ {\isacharless}\ {\isasymepsilon}{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ p\ x\ {\isacharequal}\ {\isacharparenleft}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharasterisk}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ {\isasymxi}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}poly\ p\ {\isasymxi}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ field{\isacharunderscore}simps{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ p\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isacharparenright}\ {\isacharasterisk}\ sgn\ {\isacharparenleft}poly\ q\ {\isasymxi}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymepsilon}{\isacharunderscore}props\ {\isasymxi}{\isacharunderscore}props\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ q{\isacharunderscore}pderiv\ sgn{\isacharunderscore}mult{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ {\isasymxi}{\isacharunderscore}props\ {\isasymepsilon}{\isacharunderscore}props\ {\isacharbackquoteopen}{\isasymbar}x\ {\isacharminus}\ x\isactrlsub {\isadigit{0}}{\isasymbar}\ {\isacharless}\ {\isasymepsilon}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}t{\isachardot}\ x\ {\isasymle}\ t\ {\isasymand}\ t\ {\isasymle}\ {\isasymxi}\ {\isasymlongrightarrow}\ poly\ q\ t\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ q\ {\isasymxi}{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isasymxi}{\isacharunderscore}props\ {\isasymepsilon}{\isacharunderscore}props\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule{\isacharunderscore}tac\ sym{\isacharcomma}\ intro\ no{\isacharunderscore}roots{\isacharunderscore}inbetween{\isacharunderscore}imp{\isacharunderscore}same{\isacharunderscore}sign{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ False\ {\isacharbackquoteopen}x\ {\isasymnoteq}\ x\isactrlsub {\isadigit{0}}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}mult\ sqr{\isacharunderscore}pos{\isacharparenright}\ \isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}firsttwo{\isacharunderscore}signs{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ ps\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}real\ poly\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ squarefree{\isacharcolon}\ {\isachardoublequoteopen}rsquarefree\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ p{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ {\isacharparenleft}x\isactrlsub {\isadigit{0}}{\isacharcolon}{\isacharcolon}real{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p\ {\isacharasterisk}\ sturm\ p\ {\isacharbang}\ {\isadigit{1}}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ rsquarefree{\isacharunderscore}roots{\isacharparenright}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ squarefree\ p{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}pderiv\ p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ \ add{\isacharcolon}rsquarefree{\isacharunderscore}roots{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ sturm{\isacharunderscore}firsttwo{\isacharunderscore}signs{\isacharunderscore}aux{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ simp{\isacharunderscore}all\ add{\isacharcolon}\ rsquarefree{\isacharunderscore}roots{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}signs{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ squarefree{\isacharcolon}\ {\isachardoublequoteopen}rsquarefree\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ i{\isacharunderscore}in{\isacharunderscore}range{\isacharcolon}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm\ {\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{assumes}\ q{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}poly\ {\isacharquery}q\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharasterisk}\ poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}poly\ {\isacharquery}p\ x\ {\isacharasterisk}\ poly\ {\isacharquery}r\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}indices{\isacharbrackleft}OF\ i{\isacharunderscore}in{\isacharunderscore}range{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isacharminus}\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ i\ mod\ sturm\ p\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}r\ {\isacharequal}\ {\isacharminus}\ {\isacharparenleft}{\isacharquery}p\ mod\ {\isacharquery}q{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharminus}{\isacharquery}r\ {\isacharequal}\ {\isacharquery}p\ mod\ {\isacharquery}q{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ mod{\isacharunderscore}div{\isacharunderscore}equality{\isacharbrackleft}of\ {\isacharquery}p\ {\isacharquery}q{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}p\ div\ {\isacharquery}q\ {\isacharasterisk}\ {\isacharquery}q\ {\isacharminus}\ {\isacharquery}r\ {\isacharequal}\ {\isacharquery}p{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharparenleft}{\isacharquery}p\ div\ {\isacharquery}q{\isacharparenright}\ x\ {\isacharasterisk}\ poly\ {\isacharquery}q\ x\ {\isacharminus}\ poly\ {\isacharquery}r\ x\ {\isacharequal}\ poly\ {\isacharquery}p\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ poly{\isacharunderscore}diff\ poly{\isacharunderscore}mult{\isacharparenright}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ q{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}x{\isacharcolon}\ {\isachardoublequoteopen}poly\ {\isacharquery}r\ x\ {\isacharequal}\ {\isacharminus}poly\ {\isacharquery}p\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ sqr{\isacharunderscore}pos{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}x{\isacharcolon}{\isacharcolon}real{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ x\ {\isacharasterisk}\ x\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}x\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ mult{\isacharunderscore}pos{\isacharunderscore}pos\ mult{\isacharunderscore}neg{\isacharunderscore}neg{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}not{\isacharunderscore}squarefree{\isacharbrackleft}of\ i\ p{\isacharbrackright}\ assms\ r{\isacharunderscore}x\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharquery}p\ x\ {\isacharasterisk}\ poly\ {\isacharquery}p\ x\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ intro{\isacharcolon}\ sqr{\isacharunderscore}pos{\isacharparenright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharquery}r\ x\ {\isacharasterisk}\ poly\ {\isacharquery}p\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
If \isa{p} contains no multiple roots, \isa{sturm\ p}, i.e. 
  the canonical Sturm sequence for p, is a squarefree Sturm sequence 
  that can be used to determine the number of roots of \isa{p}.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}sturm{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ \isanewline
\ \ \ \isakeyword{assumes}\ {\isachardoublequoteopen}rsquarefree\ p{\isachardoublequoteclose}\isanewline
\ \ \ \isakeyword{shows}\ {\isachardoublequoteopen}sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isacharparenleft}sturm\ p{\isacharparenright}\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sturm\ p\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}hd\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isacharequal}\ p{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ {\isasymnot}{\isacharparenleft}poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}\ {\isasymand}\ poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isadigit{1}}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ rsquarefree{\isacharunderscore}roots{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ {\isacharcolon}{\isacharcolon}\ real\ \isakeyword{and}\ y\ {\isacharcolon}{\isacharcolon}\ real\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}degree\ {\isacharparenleft}last\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ c\ \isakeyword{where}\ {\isachardoublequoteopen}last\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharcolon}c{\isacharcolon}{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}last\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isachardoublequoteclose}{\isacharcomma}\ simp\ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharparenright}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isacharparenright}\ y{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}firsttwo{\isacharunderscore}signs{\isacharbrackleft}OF\ assms{\isacharbrackright}\ \isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x\isactrlsub {\isadigit{0}}{\isachardot}\ poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p{\isacharasterisk}sturm\ p\ {\isacharbang}\ {\isadigit{1}}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}signs{\isacharbrackleft}OF\ assms{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}i\ x{\isachardot}\ {\isasymlbrakk}i\ {\isacharless}\ length\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isacharminus}\ {\isadigit{2}}{\isacharsemicolon}\ poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharasterisk}\ poly\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsection{Canonical squarefree Sturm sequence%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
This removes multiple roots from \isa{p} by dividing it by 
  its gcd with its derivative. The resulting polynomials has the same 
  roots as \isa{p}, but with multiplicity 1.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p\ {\isacharequal}\ sturm\ {\isacharparenleft}p\ div\ {\isacharparenleft}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharunderscore}not{\isacharunderscore}Nil{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sturm{\isacharunderscore}squarefree{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p{\isacharprime}\ {\isasymequiv}\ p\ div\ gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p{\isacharparenright}\ p{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}rsquarefree\ p{\isacharprime}{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}subst\ rsquarefree{\isacharunderscore}roots{\isacharcomma}\ clarify{\isacharparenright}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}pderiv\ p{\isacharprime}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbrackleft}{\isacharcolon}{\isacharminus}x{\isacharcomma}{\isadigit{1}}{\isacharcolon}{\isacharbrackright}\ dvd\ gcd\ p{\isacharprime}\ {\isacharparenleft}pderiv\ p{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ poly{\isacharunderscore}eq{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}iff{\isacharunderscore}dvd{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}gcd\ p{\isacharprime}\ {\isacharparenleft}pderiv\ p{\isacharprime}{\isacharparenright}\ {\isacharequal}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ poly{\isacharunderscore}eq{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}iff{\isacharunderscore}dvd{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}sturm{\isacharbrackleft}OF\ {\isacharbackquoteopen}rsquarefree\ p{\isacharprime}{\isacharbackquoteclose}{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharcolon}\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p{\isachardoublequoteclose}\ p{\isacharprime}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sturm{\isacharunderscore}squarefree{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p{\isacharparenright}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p{\isacharparenright}{\isacharparenright}\ y{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}hd\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p{\isacharparenright}\ {\isacharequal}\ p{\isacharprime}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sturm{\isacharunderscore}squarefree{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p{\isacharparenright}\ {\isasymge}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p\ {\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ p{\isacharprime}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p\ {\isacharbang}\ Suc\ {\isadigit{0}}\ {\isacharequal}\ pderiv\ p{\isacharprime}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ sturm{\isacharunderscore}squarefree{\isacharunderscore}def{\isacharparenright}\ \isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ {\isacharbackquoteopen}rsquarefree\ p{\isacharprime}{\isacharbackquoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ {\isasymnot}\ {\isacharparenleft}poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}\ {\isasymand}\ poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p\ {\isacharbang}\ {\isadigit{1}}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ rsquarefree{\isacharunderscore}roots{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isachardot}signs\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}i\ x{\isachardot}\ {\isasymlbrakk}i\ {\isacharless}\ length\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p{\isacharparenright}\ {\isacharminus}\ {\isadigit{2}}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharasterisk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree\ p\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isachardot}deriv\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x\isactrlsub {\isadigit{0}}{\isachardot}\ poly\ p{\isacharprime}\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p{\isacharprime}\ {\isacharasterisk}\ sturm{\isacharunderscore}squarefree\ p\ {\isacharbang}\ {\isadigit{1}}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x\ {\isachargreater}\ x\isactrlsub {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsection{Optimisation for non-multiple roots%
}
\isamarkuptrue%
%
\begin{isamarkuptext}%
We can also define the following non-canonical Sturm sequence that 
  is obtained by taking the canonical Sturm sequence of \isa{p}
  (possibly with multiple roots) and then dividing the entire 
  sequence by the gcd of p and its derivative.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharequal}\ {\isacharparenleft}let\ d\ {\isacharequal}\ gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ map\ {\isacharparenleft}{\isasymlambda}p{\isacharprime}{\isachardot}\ p{\isacharprime}\ div\ d{\isacharparenright}\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}propagate{\isacharunderscore}left{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ {\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymforall}j{\isasymle}i{\isacharplus}{\isadigit{1}}{\isachardot}\ poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ j{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}intro\ sturm{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}aux{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharcomma}{\isadigit{4}}{\isacharparenright}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{1}}\ i\ x{\isacharparenright}\isanewline
\ \ \ \ \isacommand{def}\isamarkupfalse%
\ q\ {\isasymequiv}\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ i{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{def}\isamarkupfalse%
\ r\ {\isasymequiv}\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ {\isacharparenleft}Suc\ i{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{def}\isamarkupfalse%
\ s\ {\isasymequiv}\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ {\isacharparenleft}Suc\ {\isacharparenleft}Suc\ i{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{def}\isamarkupfalse%
\ d\ {\isasymequiv}\ {\isachardoublequoteopen}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{def}\isamarkupfalse%
\ q{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}q\ div\ d{\isachardoublequoteclose}\ \isakeyword{and}\ r{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}r\ div\ d{\isachardoublequoteclose}\ \isakeyword{and}\ s{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}s\ div\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ i{\isacharunderscore}in{\isacharunderscore}range{\isacharcolon}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isacharminus}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}d\ dvd\ q{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ dvd\ r{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ dvd\ s{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ q{\isacharunderscore}def\ r{\isacharunderscore}def\ s{\isacharunderscore}def\ d{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ i{\isacharunderscore}in{\isacharunderscore}range\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharcolon}\ sturm{\isacharunderscore}gcd{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ qrs{\isacharunderscore}simps{\isacharcolon}\ {\isachardoublequoteopen}q\ {\isacharequal}\ q{\isacharprime}\ {\isacharasterisk}\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}r\ {\isacharequal}\ r{\isacharprime}\ {\isacharasterisk}\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}s\ {\isacharequal}\ s{\isacharprime}\ {\isacharasterisk}\ d{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ q{\isacharprime}{\isacharunderscore}def\ r{\isacharprime}{\isacharunderscore}def\ s{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ dvd{\isacharunderscore}div{\isacharunderscore}mult{\isacharunderscore}self{\isacharparenright}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ goal{\isadigit{1}}{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ i{\isacharunderscore}in{\isacharunderscore}range\ \isacommand{have}\isamarkupfalse%
\ r{\isacharprime}{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ r{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ r{\isacharprime}{\isacharunderscore}def\ r{\isacharunderscore}def\ d{\isacharunderscore}def\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ r{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ r\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ {\isacharbackquoteopen}r\ {\isacharequal}\ r{\isacharprime}\ {\isacharasterisk}\ d{\isacharbackquoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}indices{\isacharbrackleft}OF\ i{\isacharunderscore}in{\isacharunderscore}range{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isacharequal}\ q\ div\ r\ {\isacharasterisk}\ r\ {\isacharminus}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ q{\isacharunderscore}def\ r{\isacharunderscore}def\ s{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ mod{\isacharunderscore}div{\isacharunderscore}equality{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}q{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}q\ div\ r\ {\isacharasterisk}\ r\ {\isacharminus}\ s{\isacharparenright}\ div\ d{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ q{\isacharprime}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ {\isacharparenleft}q\ div\ r\ {\isacharasterisk}\ r{\isacharparenright}\ div\ d\ {\isacharminus}\ s{\isacharprime}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ s{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ div{\isacharunderscore}diff{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ q\ div\ r\ {\isacharasterisk}\ r{\isacharprime}\ {\isacharminus}\ s{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ dvd{\isacharunderscore}div{\isacharunderscore}mult{\isacharbrackleft}OF\ {\isacharbackquoteopen}d\ dvd\ r{\isacharbackquoteclose}{\isacharcomma}\ of\ {\isachardoublequoteopen}q\ div\ r{\isachardoublequoteclose}{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ algebra{\isacharunderscore}simps\ r{\isacharprime}{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ div\ r\ {\isacharequal}\ q{\isacharprime}\ div\ r{\isacharprime}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ qrs{\isacharunderscore}simps\ {\isacharbackquoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ q{\isacharprime}\ x\ {\isacharequal}\ poly\ {\isacharparenleft}q{\isacharprime}\ div\ r{\isacharprime}\ {\isacharasterisk}\ r{\isacharprime}\ {\isacharminus}\ s{\isacharprime}{\isacharparenright}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ r{\isacharprime}{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isachardot}\ {\isacharequal}\ {\isacharminus}poly\ s{\isacharprime}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ s{\isacharprime}\ x\ {\isacharequal}\ {\isacharminus}poly\ q{\isacharprime}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{using}\isamarkupfalse%
\ i{\isacharunderscore}in{\isacharunderscore}range\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ q{\isacharprime}{\isacharunderscore}def\ s{\isacharprime}{\isacharunderscore}def\ q{\isacharunderscore}def\ s{\isacharunderscore}def\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ d{\isacharunderscore}def\ sgn{\isacharunderscore}minus{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}adjacent{\isacharunderscore}roots{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ {\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ False\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ d\ {\isasymequiv}\ {\isachardoublequoteopen}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}adjacent{\isacharunderscore}root{\isacharunderscore}propagate{\isacharunderscore}left{\isacharbrackleft}OF\ assms{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ {\isadigit{0}}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ {\isadigit{1}}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharparenleft}p\ div\ d{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}pderiv\ p\ div\ d{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ d{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ div{\isacharunderscore}gcd{\isacharunderscore}coprime{\isacharunderscore}poly\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}coprime\ {\isacharparenleft}p\ div\ d{\isacharparenright}\ {\isacharparenleft}pderiv\ p\ div\ d{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ coprime{\isacharunderscore}imp{\isacharunderscore}no{\isacharunderscore}common{\isacharunderscore}roots\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}signs{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ i{\isacharunderscore}in{\isacharunderscore}range{\isacharcolon}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ {\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{2}}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{assumes}\ q{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}poly\ {\isacharquery}q\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharasterisk}\ \isanewline
\ \ \ \ \ \ \ \ \ poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}poly\ {\isacharquery}r\ x\ {\isacharasterisk}\ poly\ {\isacharquery}p\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ d\ {\isasymequiv}\ {\isachardoublequoteopen}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ coprime{\isacharunderscore}imp{\isacharunderscore}no{\isacharunderscore}common{\isacharunderscore}roots\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ rsquarefree{\isacharcolon}\ {\isachardoublequoteopen}rsquarefree\ {\isacharparenleft}p\ div\ d{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ rsquarefree{\isacharunderscore}roots\ d{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ i{\isacharunderscore}in{\isacharunderscore}range\ \isacommand{have}\isamarkupfalse%
\ i{\isacharunderscore}in{\isacharunderscore}range{\isacharprime}{\isacharcolon}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isacharminus}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}d\ dvd\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ i{\isacharparenright}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}d\ dvd\ {\isacharquery}p{\isacharprime}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}d\ dvd\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isacharparenleft}Suc\ i{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}d\ dvd\ {\isacharquery}q{\isacharprime}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}d\ dvd\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ {\isacharparenleft}Suc\ {\isacharparenleft}Suc\ i{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}d\ dvd\ {\isacharquery}r{\isacharprime}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharcolon}\ sturm{\isacharunderscore}gcd{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ pqr{\isacharunderscore}simps{\isacharcolon}\ {\isachardoublequoteopen}{\isacharquery}p{\isacharprime}\ {\isacharequal}\ {\isacharquery}p\ {\isacharasterisk}\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharquery}q{\isacharprime}\ {\isacharequal}\ {\isacharquery}q\ {\isacharasterisk}\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharquery}r{\isacharprime}\ {\isacharequal}\ {\isacharquery}r\ {\isacharasterisk}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ d{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ i{\isacharunderscore}in{\isacharunderscore}range{\isacharprime}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ dvd{\isacharunderscore}div{\isacharunderscore}mult{\isacharunderscore}self{\isacharparenright}\ \isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ q{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ q{\isacharprime}{\isacharunderscore}{\isadigit{0}}{\isacharcolon}\ {\isachardoublequoteopen}poly\ {\isacharquery}q{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}indices{\isacharbrackleft}OF\ i{\isacharunderscore}in{\isacharunderscore}range{\isacharprime}{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sturm\ p\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isacharminus}\ {\isacharparenleft}sturm\ p\ {\isacharbang}\ i\ mod\ sturm\ p\ {\isacharbang}\ {\isacharparenleft}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharminus}{\isacharquery}r{\isacharprime}\ {\isacharequal}\ {\isacharquery}p{\isacharprime}\ mod\ {\isacharquery}q{\isacharprime}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ mod{\isacharunderscore}div{\isacharunderscore}equality{\isacharbrackleft}of\ {\isacharquery}p{\isacharprime}\ {\isacharquery}q{\isacharprime}{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}p{\isacharprime}\ div\ {\isacharquery}q{\isacharprime}\ {\isacharasterisk}\ {\isacharquery}q{\isacharprime}\ {\isacharminus}\ {\isacharquery}r{\isacharprime}\ {\isacharequal}\ {\isacharquery}p{\isacharprime}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}d{\isacharasterisk}{\isacharparenleft}{\isacharquery}p\ div\ {\isacharquery}q\ {\isacharasterisk}\ {\isacharquery}q\ {\isacharminus}\ {\isacharquery}r{\isacharparenright}\ {\isacharequal}\ d{\isacharasterisk}\ {\isacharquery}p{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ pqr{\isacharunderscore}simps\ algebra{\isacharunderscore}simps{\isacharparenright}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}p\ div\ {\isacharquery}q\ {\isacharasterisk}\ {\isacharquery}q\ {\isacharminus}\ {\isacharquery}r\ {\isacharequal}\ {\isacharquery}p{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharparenleft}{\isacharquery}p\ div\ {\isacharquery}q{\isacharparenright}\ x\ {\isacharasterisk}\ poly\ {\isacharquery}q\ x\ {\isacharminus}\ poly\ {\isacharquery}r\ x\ {\isacharequal}\ poly\ {\isacharquery}p\ x{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ poly{\isacharunderscore}diff\ poly{\isacharunderscore}mult{\isacharparenright}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ q{\isacharunderscore}{\isadigit{0}}\ \isacommand{have}\isamarkupfalse%
\ r{\isacharunderscore}x{\isacharcolon}\ {\isachardoublequoteopen}poly\ {\isacharquery}r\ x\ {\isacharequal}\ {\isacharminus}poly\ {\isacharquery}p\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}adjacent{\isacharunderscore}roots{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ i{\isacharunderscore}in{\isacharunderscore}range\ q{\isacharunderscore}{\isadigit{0}}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharquery}p\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ sqr{\isacharunderscore}pos{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}x{\isacharcolon}{\isacharcolon}real{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ x\ {\isacharasterisk}\ x\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}x\ {\isasymge}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ mult{\isacharunderscore}pos{\isacharunderscore}pos\ mult{\isacharunderscore}neg{\isacharunderscore}neg{\isacharparenright}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ r{\isacharunderscore}x\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This approach indeed also yields a valid squarefree Sturm sequence
  for the polynomial \isa{p\ {\isacharslash}\ q}.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharprime}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}p\ {\isacharcolon}{\isacharcolon}\ real\ poly{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}d\ {\isasymequiv}\ gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p{\isacharparenright}\ {\isacharparenleft}p\ div\ d{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isacharquery}ps{\isacharprime}\ {\isacharquery}p{\isacharprime}{\isachardoublequoteclose}{\isacharparenright}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}ps{\isacharprime}\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}hd\ {\isacharquery}ps{\isacharprime}\ {\isacharequal}\ {\isacharquery}p{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isasymle}\ length\ {\isacharquery}ps{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ d{\isacharunderscore}def\ hd{\isacharunderscore}map{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}d\ dvd\ last\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}rule\ sturm{\isacharunderscore}gcd{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}last\ {\isacharparenleft}sturm\ p{\isacharparenright}\ {\isacharequal}\ last\ {\isacharquery}ps{\isacharprime}\ {\isacharasterisk}\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ last{\isacharunderscore}map\ d{\isacharunderscore}def\ dvd{\isacharunderscore}div{\isacharunderscore}mult{\isacharunderscore}self{\isacharparenright}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ this\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}last\ {\isacharquery}ps{\isacharprime}\ dvd\ last\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ dvd{\isacharunderscore}imp{\isacharunderscore}degree{\isacharunderscore}le{\isacharbrackleft}OF\ this{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}degree\ {\isacharparenleft}last\ {\isacharquery}ps{\isacharprime}{\isacharparenright}\ {\isasymle}\ degree\ {\isacharparenleft}last\ {\isacharparenleft}sturm\ p{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}last\ {\isacharquery}ps{\isacharprime}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharcomma}\ auto{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}degree\ {\isacharparenleft}last\ {\isacharquery}ps{\isacharprime}{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ c\ \isakeyword{where}\ {\isachardoublequoteopen}last\ {\isacharquery}ps{\isacharprime}\ {\isacharequal}\ {\isacharbrackleft}{\isacharcolon}c{\isacharcolon}{\isacharbrackright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}last\ {\isacharquery}ps{\isacharprime}{\isachardoublequoteclose}{\isacharcomma}\ simp\ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharparenright}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}x\ y{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ {\isacharquery}ps{\isacharprime}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}last\ {\isacharquery}ps{\isacharprime}{\isacharparenright}\ y{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ squarefree{\isacharcolon}\ {\isachardoublequoteopen}rsquarefree\ {\isacharquery}p{\isacharprime}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ rsquarefree{\isacharunderscore}roots{\isacharcomma}\ unfold\ d{\isacharunderscore}def{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ intro\ allI\ coprime{\isacharunderscore}imp{\isacharunderscore}no{\isacharunderscore}common{\isacharunderscore}roots\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ Suc\ {\isadigit{0}}\ {\isacharequal}\ pderiv\ p\ div\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ sturm{\isacharunderscore}def\ d{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ coprime{\isacharcolon}\ {\isachardoublequoteopen}coprime\ {\isacharquery}p{\isacharprime}\ {\isacharparenleft}pderiv\ p\ div\ d{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ div{\isacharunderscore}gcd{\isacharunderscore}coprime{\isacharunderscore}poly\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ squarefree{\isacharprime}{\isacharcolon}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}x{\isachardot}\ {\isasymnot}\ {\isacharparenleft}poly\ {\isacharparenleft}p\ div\ d{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}\ {\isasymand}\ poly\ {\isacharparenleft}sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ {\isadigit{1}}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ coprime{\isacharunderscore}imp{\isacharunderscore}no{\isacharunderscore}common{\isacharunderscore}roots\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}signs{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}i\ x{\isachardot}\ {\isasymlbrakk}i\ {\isacharless}\ length\ {\isacharquery}ps{\isacharprime}\ {\isacharminus}\ {\isadigit{2}}{\isacharsemicolon}\ poly\ {\isacharparenleft}{\isacharquery}ps{\isacharprime}\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isasymrbrakk}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymLongrightarrow}\ poly\ {\isacharparenleft}{\isacharquery}ps{\isacharprime}\ {\isacharbang}\ {\isacharparenleft}i\ {\isacharplus}\ {\isadigit{2}}{\isacharparenright}{\isacharparenright}\ x\ {\isacharasterisk}\ poly\ {\isacharparenleft}{\isacharquery}ps{\isacharprime}\ {\isacharbang}\ i{\isacharparenright}\ x\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharquery}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ squarefree\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ rsquarefree{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}{\isacharquery}p{\isacharprime}\ {\isacharequal}\ {\isacharquery}ps{\isacharprime}\ {\isacharbang}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}pderiv\ p\ div\ d\ {\isacharequal}\ {\isacharquery}ps{\isacharprime}\ {\isacharbang}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ d{\isacharunderscore}def\ sturm{\isacharunderscore}def{\isacharcomma}\isanewline
\ \ \ \ \ \ \ \ \ \ subst\ sturm{\isacharunderscore}aux{\isachardot}simps{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharquery}ps{\isacharprime}\ {\isacharbang}\ {\isadigit{0}}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ squarefree\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ A\ rsquarefree{\isacharunderscore}def{\isacharparenright}\isanewline
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isactrlsub {\isadigit{0}}\ {\isacharcolon}{\isacharcolon}\ real\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharquery}p{\isacharprime}\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}pderiv\ p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ dest{\isacharcolon}\ pderiv{\isacharunderscore}iszero{\isacharparenright}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}poly\ p\ x\isactrlsub {\isadigit{0}}\ {\isacharequal}\ {\isadigit{0}}{\isacharbackquoteclose}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p\ {\isacharasterisk}\ pderiv\ p{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x\isactrlsub {\isadigit{0}}\ {\isacharless}\ x\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ sturm{\isacharunderscore}firsttwo{\isacharunderscore}signs{\isacharunderscore}aux{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ ev\ {\isacharequal}\ eventually{\isacharunderscore}conj{\isacharbrackleft}OF\ A\ poly{\isacharunderscore}neighbourhood{\isacharunderscore}without{\isacharunderscore}roots{\isacharbrackleft}OF\ {\isacharbackquoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}{\isacharbrackright}\isanewline
\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eventually\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}p\ div\ d\ {\isacharasterisk}\ sturm{\isacharunderscore}squarefree{\isacharprime}\ p\ {\isacharbang}\ {\isadigit{1}}{\isacharparenright}\ x{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}if\ x\isactrlsub {\isadigit{0}}\ {\isacharless}\ x\ then\ {\isadigit{1}}\ else\ {\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}at\ x\isactrlsub {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}rule\ eventually{\isacharunderscore}mono{\isacharbrackleft}OF\ {\isacharunderscore}\ ev{\isacharbrackright}{\isacharcomma}\ clarify{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}intro{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}a\ {\isacharparenleft}b{\isacharcolon}{\isacharcolon}real{\isacharparenright}{\isachardot}\ b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ a\ {\isacharless}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ a\ {\isacharslash}\ {\isacharparenleft}b\ {\isacharasterisk}\ b{\isacharparenright}\ {\isacharless}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymAnd}a\ {\isacharparenleft}b{\isacharcolon}{\isacharcolon}real{\isacharparenright}{\isachardot}\ b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ a\ {\isachargreater}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ a\ {\isacharslash}\ {\isacharparenleft}b\ {\isacharasterisk}\ b{\isacharparenright}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}b\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharcomma}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ auto\ simp{\isacharcolon}\ mult{\isacharunderscore}pos{\isacharunderscore}pos\ mult{\isacharunderscore}neg{\isacharunderscore}neg\ field{\isacharunderscore}simps{\isacharparenright}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isacharplus}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}goal{\isadigit{1}}\ x{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ \ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}poly\ d\ x\ {\isacharasterisk}\ poly\ d\ x\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}poly\ d\ x\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharcomma}\ auto\ simp{\isacharcolon}\ mult{\isacharunderscore}pos{\isacharunderscore}pos\ mult{\isacharunderscore}neg{\isacharunderscore}neg{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharunderscore}aux{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}pderiv\ p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ {\isacharparenleft}p\ div\ d{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}\ {\isasymlongleftrightarrow}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ d{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}d\ dvd\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ dvd\ pderiv\ p{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{using}\isamarkupfalse%
\ goal{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sgn{\isacharunderscore}real{\isacharunderscore}def\ poly{\isacharunderscore}div\ not{\isacharunderscore}less{\isacharbrackleft}symmetric{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ zero{\isacharunderscore}less{\isacharunderscore}divide{\isacharunderscore}iff\ split{\isacharcolon}\ split{\isacharunderscore}if{\isacharunderscore}asm{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Critically, unless \isa{x} is a multiple root of \isa{p} 
  (i.e. a root of both \isa{p} and its derivative), the number 
  of sign changes in the non-canonical Sturm sequence we defined 
  is the same as the number of sign changes in the canonical Sturm 
  sequence. Therefore we can use the canonical Sturm sequence 
  even in the non-squarefree case if the borders of the interval 
  we are interested in are not multiple roots of the polynomial.%
\end{isamarkuptext}%
\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}mult{\isacharunderscore}aux{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymnoteq}\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}real{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ {\isacharparenleft}group\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}map\ {\isacharparenleft}op\ {\isacharasterisk}d\ {\isasymcirc}\ f{\isacharparenright}\ xs{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ length\ {\isacharparenleft}group\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}map\ f\ xs{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ inj{\isacharcolon}\ {\isachardoublequoteopen}inj\ {\isacharparenleft}op\ {\isacharasterisk}d{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharcolon}\ injI{\isacharparenright}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isacharparenleft}op{\isacharasterisk}\ d\ {\isasymcirc}\ f{\isacharparenright}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isacharequal}\ filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ f\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}filter\ {\isacharparenleft}{\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isasymcirc}\ f{\isacharparenright}\ {\isacharequal}\ filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ f\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp{\isacharunderscore}all\ add{\isacharcolon}\ o{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isacharparenleft}map\ {\isacharparenleft}op{\isacharasterisk}\ d\ {\isasymcirc}\ f{\isacharparenright}\ xs{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ map\ {\isacharparenleft}op{\isacharasterisk}\ d\ {\isasymcirc}\ f{\isacharparenright}\ {\isacharparenleft}filter\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isacharparenleft}op{\isacharasterisk}\ d\ {\isasymcirc}\ f{\isacharparenright}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ xs{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ filter{\isacharunderscore}map\ o{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ group{\isacharunderscore}map{\isacharunderscore}injective{\isacharbrackleft}OF\ inj{\isacharbrackright}\ assms\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ filter{\isacharunderscore}map\ map{\isacharunderscore}map{\isacharbrackleft}symmetric{\isacharbrackright}\ del{\isacharcolon}\ map{\isacharunderscore}map{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ p\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}real\ poly{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{defines}\ {\isachardoublequoteopen}ps\ {\isasymequiv}\ sturm\ p{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}ps{\isacharprime}\ {\isasymequiv}\ sturm{\isacharunderscore}squarefree{\isacharprime}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isacharprime}\ {\isacharequal}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps{\isacharprime}\ {\isacharequal}\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ d\ {\isasymequiv}\ {\isachardoublequoteopen}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ p{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}p\ div\ d{\isachardoublequoteclose}\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ s{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}poly{\isacharunderscore}inf\ d{\isachardoublequoteclose}\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ s{\isacharprime}{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}poly{\isacharunderscore}neg{\isacharunderscore}inf\ d{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ {\isacharcolon}{\isacharcolon}\ real\ \isakeyword{and}\ q\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}real\ poly{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isasymin}\ set\ ps{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}d\ dvd\ q{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ ps{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ sturm{\isacharunderscore}gcd\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ q{\isacharunderscore}prod{\isacharcolon}\ {\isachardoublequoteopen}q\ {\isacharequal}\ {\isacharparenleft}q\ div\ d{\isacharparenright}\ {\isacharasterisk}\ d{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ d{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ algebra{\isacharunderscore}simps\ dvd{\isacharunderscore}mult{\isacharunderscore}div{\isacharunderscore}cancel{\isacharparenright}\isanewline
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}poly\ q\ x\ {\isacharequal}\ poly\ d\ x\ {\isacharasterisk}\ poly\ {\isacharparenleft}q\ div\ d{\isacharparenright}\ x{\isachardoublequoteclose}\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ q{\isacharunderscore}prod{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ s{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}\ {\isacharequal}\ sgn\ {\isacharparenleft}poly\ d\ x{\isacharparenright}\ {\isacharasterisk}\ sgn\ {\isacharparenleft}poly\ {\isacharparenleft}q\ div\ d{\isacharparenright}\ x{\isacharparenright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ q{\isacharunderscore}prod{\isacharcomma}\ simp\ add{\isacharcolon}\ sgn{\isacharunderscore}mult{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}inf{\isacharunderscore}mult\ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}poly{\isacharunderscore}inf\ q\ {\isacharequal}\ s{\isacharprime}\ {\isacharasterisk}\ poly{\isacharunderscore}inf\ {\isacharparenleft}q\ div\ d{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ s{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ q{\isacharunderscore}prod{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}inf{\isacharunderscore}mult\ \isacommand{have}\isamarkupfalse%
\ s{\isadigit{3}}{\isacharcolon}\ {\isachardoublequoteopen}poly{\isacharunderscore}neg{\isacharunderscore}inf\ q\ {\isacharequal}\ s{\isacharprime}{\isacharprime}\ {\isacharasterisk}\ poly{\isacharunderscore}neg{\isacharunderscore}inf\ {\isacharparenleft}q\ div\ d{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ s{\isacharprime}{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ q{\isacharunderscore}prod{\isacharcomma}\ simp{\isacharparenright}\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ s{\isadigit{1}}\ s{\isadigit{2}}\ s{\isadigit{3}}\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ signs\ {\isacharequal}\ this\isanewline
\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ f\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}real\ poly\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ \isakeyword{and}\ s\ {\isacharcolon}{\isacharcolon}\ real\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ f{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}q{\isachardot}\ q\ {\isasymin}\ set\ ps\ {\isasymLongrightarrow}\ f\ q\ {\isacharequal}\ s\ {\isacharasterisk}\ f\ {\isacharparenleft}q\ div\ d{\isacharparenright}{\isachardoublequoteclose}\ \isakeyword{and}\ s{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}inverse\ s\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isacommand{fix}\isamarkupfalse%
\ q\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}q\ {\isasymin}\ set\ ps{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isacharparenleft}q\ div\ d{\isacharparenright}\ {\isacharequal}\ inverse\ s\ {\isacharasterisk}\ f\ q{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ f{\isacharbrackleft}of\ q{\isacharbrackright}{\isacharcomma}\ simp{\isacharunderscore}all\ add{\isacharcolon}\ s{\isacharparenright}\isanewline
\ \ \ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ f{\isacharprime}\ {\isacharequal}\ this\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}group\ {\isacharbrackleft}x{\isasymleftarrow}map\ f\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}q{\isachardot}\ q\ div\ d{\isacharparenright}\ ps{\isacharparenright}{\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbrackright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ length\ {\isacharparenleft}group\ {\isacharbrackleft}x{\isasymleftarrow}map\ {\isacharparenleft}{\isasymlambda}q{\isachardot}\ f\ {\isacharparenleft}q\ div\ d{\isacharparenright}{\isacharparenright}\ ps\ {\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbrackright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ only{\isacharcolon}\ sign{\isacharunderscore}changes{\isacharunderscore}def\ o{\isacharunderscore}def\ map{\isacharunderscore}map{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}q{\isachardot}\ q\ div\ d{\isacharparenright}\ ps\ {\isacharequal}\ ps{\isacharprime}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ps{\isacharunderscore}def\ ps{\isacharprime}{\isacharunderscore}def\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ d{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ f{\isacharprime}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ {\isacharparenleft}{\isasymlambda}q{\isachardot}\ f\ {\isacharparenleft}q\ div\ d{\isacharparenright}{\isacharparenright}\ ps\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ map\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ {\isacharparenleft}op{\isacharasterisk}{\isacharparenleft}inverse\ s{\isacharparenright}\ {\isasymcirc}\ f{\isacharparenright}\ x{\isacharparenright}\ ps{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ o{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}mult{\isacharunderscore}aux{\isacharbrackleft}OF\ {\isacharbackquoteopen}inverse\ s\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharcomma}\ of\ f\ ps{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ {\isachardoublequoteopen}length\ {\isacharparenleft}group\ {\isacharbrackleft}x{\isasymleftarrow}map\ f\ ps{\isacharprime}\ {\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbrackright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}\ {\isacharequal}\isanewline
\ \ \ \ \ \ \ \ \ length\ {\isacharparenleft}group\ {\isacharbrackleft}x{\isasymleftarrow}map\ f\ ps\ {\isachardot}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbrackright}{\isacharparenright}\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ length{\isacharunderscore}group\ {\isacharequal}\ this\isanewline
\isanewline
\ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ x\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ x\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}d\ dvd\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ dvd\ pderiv\ p{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ A\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sgn\ {\isacharparenleft}poly\ d\ x{\isacharparenright}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ sgn{\isacharunderscore}zero{\isacharunderscore}iff\ elim{\isacharcolon}\ dvdE{\isacharparenright}\ \isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes\ ps{\isacharprime}\ x\ {\isacharequal}\ sign{\isacharunderscore}changes\ ps\ x{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ signs{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ length{\isacharunderscore}group{\isacharbrackleft}of\ {\isachardoublequoteopen}{\isasymlambda}q{\isachardot}\ sgn\ {\isacharparenleft}poly\ q\ x{\isacharparenright}{\isachardoublequoteclose}{\isacharbrackright}{\isacharcomma}\ simp{\isacharunderscore}all{\isacharparenright}\isanewline
\ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}s{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}s{\isacharprime}{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ s{\isacharprime}{\isacharunderscore}def\ s{\isacharprime}{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ length{\isacharunderscore}group{\isacharbrackleft}of\ poly{\isacharunderscore}inf\ s{\isacharprime}{\isacharcomma}\ OF\ signs{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ {\isacharbackquoteopen}s{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isacharprime}\ {\isacharequal}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}inf{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ length{\isacharunderscore}group{\isacharbrackleft}of\ poly{\isacharunderscore}neg{\isacharunderscore}inf\ s{\isacharprime}{\isacharprime}{\isacharcomma}\ OF\ signs{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ {\isacharbackquoteopen}s{\isacharprime}{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps{\isacharprime}\ {\isacharequal}\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isamarkupsection{Root-counting functions%
}
\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}between\ p\ a\ b\ {\isacharequal}\ {\isacharparenleft}if\ a\ {\isasymle}\ b\ {\isasymand}\ p\ {\isasymnoteq}\ {\isadigit{0}}\ then\ \isanewline
\ \ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm{\isacharunderscore}squarefree\ p\isanewline
\ \ \ \ in\ sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ b{\isacharparenright}\ else\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ count{\isacharunderscore}roots\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}count{\isacharunderscore}roots\ p\ {\isacharequal}\ {\isacharparenleft}if\ {\isacharparenleft}p{\isacharcolon}{\isacharcolon}real\ poly{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\isanewline
\ \ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm{\isacharunderscore}squarefree\ p\isanewline
\ \ \ \ in\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}above\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}above\ p\ a\ {\isacharequal}\ {\isacharparenleft}if\ {\isacharparenleft}p{\isacharcolon}{\isacharcolon}real\ poly{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\isanewline
\ \ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm{\isacharunderscore}squarefree\ p\isanewline
\ \ \ \ in\ sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}below\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}below\ p\ a\ {\isacharequal}\ {\isacharparenleft}if\ {\isacharparenleft}p{\isacharcolon}{\isacharcolon}real\ poly{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\isanewline
\ \ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm{\isacharunderscore}squarefree\ p\isanewline
\ \ \ \ in\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ a{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharunderscore}correct{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}between\ p\ a\ b\ {\isacharequal}\ card\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymand}\ a\ {\isasymle}\ b{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ False{\isacharprime}\ {\isacharequal}\ this\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isacharless}\ b{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ False\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ subset{\isacharcolon}\ {\isachardoublequoteopen}{\isacharbraceleft}a{\isacharless}{\isachardot}{\isachardot}{\isacharless}b{\isacharbraceright}\ {\isasymsubseteq}\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ real{\isacharunderscore}infinite{\isacharunderscore}interval{\isacharbrackleft}OF\ True{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}finite\ {\isacharbraceleft}a{\isacharless}{\isachardot}{\isachardot}{\isacharless}b{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}finite\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}subset{\isacharbrackleft}OF\ subset{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ False{\isacharprime}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ not{\isacharunderscore}less\ card{\isacharunderscore}eq{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}iff{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharunderscore}def\ Let{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ False\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}a\ {\isasymle}\ b{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ p{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}p\ div\ {\isacharparenleft}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ clarsimp\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p{\isachardoublequoteclose}\ p{\isacharprime}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}roots{\isacharunderscore}finite{\isacharbrackleft}OF\ {\isacharbackquoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}between\ p\ a\ b\ {\isacharequal}\ card\ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharunderscore}def\ Let{\isacharunderscore}def\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ True\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharbrackleft}OF\ {\isacharbackquoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}a\ {\isasymle}\ b{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}correct{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ p\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}real\ poly{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}count{\isacharunderscore}roots\ p\ {\isacharequal}\ card\ {\isacharbraceleft}x{\isachardot}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharunderscore}\ {\isacharequal}\ card\ {\isacharquery}S{\isachardoublequoteclose}{\isacharparenright}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}p\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ real{\isacharunderscore}infinite{\isacharunderscore}interval{\isacharbrackleft}of\ {\isadigit{0}}\ {\isadigit{1}}{\isacharbrackright}\ finite{\isacharunderscore}subset{\isacharbrackleft}of\ {\isachardoublequoteopen}{\isacharbraceleft}{\isadigit{0}}{\isacharless}{\isachardot}{\isachardot}{\isacharless}{\isadigit{1}}{\isacharbraceright}{\isachardoublequoteclose}\ {\isacharquery}S{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}finite\ {\isacharbraceleft}x{\isachardot}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ count{\isacharunderscore}roots{\isacharunderscore}def\ True{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ p{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}p\ div\ {\isacharparenleft}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ clarsimp\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p{\isachardoublequoteclose}\ p{\isacharprime}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharbrackleft}OF\ {\isacharbackquoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}roots\ p\ {\isacharequal}\ card\ {\isacharbraceleft}x{\isachardot}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}def\ Let{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}x{\isachardot}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharunderscore}correct{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ p\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}real\ poly{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}above\ p\ a\ {\isacharequal}\ card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharunderscore}\ {\isacharequal}\ card\ {\isacharquery}S{\isachardoublequoteclose}{\isacharparenright}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}p\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ real{\isacharunderscore}infinite{\isacharunderscore}interval{\isacharbrackleft}of\ a\ {\isachardoublequoteopen}a{\isacharplus}{\isadigit{1}}{\isachardoublequoteclose}{\isacharbrackright}\ finite{\isacharunderscore}subset{\isacharbrackleft}of\ {\isachardoublequoteopen}{\isacharbraceleft}a{\isacharless}{\isachardot}{\isachardot}{\isacharless}a{\isacharplus}{\isadigit{1}}{\isacharbraceright}{\isachardoublequoteclose}\ {\isacharquery}S{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}finite\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharunderscore}def\ True{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ p{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}p\ div\ {\isacharparenleft}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ clarsimp\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p{\isachardoublequoteclose}\ p{\isacharprime}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharbrackleft}OF\ {\isacharbackquoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}above\ p\ a\ {\isacharequal}\ card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharunderscore}def\ Let{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}x{\isachardot}\ x\ {\isachargreater}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharunderscore}correct{\isacharcolon}\isanewline
\ \ \isakeyword{fixes}\ p\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}real\ poly{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}below\ p\ a\ {\isacharequal}\ card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharunderscore}\ {\isacharequal}\ card\ {\isacharquery}S{\isachardoublequoteclose}{\isacharparenright}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}p\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ real{\isacharunderscore}infinite{\isacharunderscore}interval{\isacharbrackleft}of\ {\isachardoublequoteopen}a\ {\isacharminus}\ {\isadigit{1}}{\isachardoublequoteclose}\ a{\isacharbrackright}\ \isanewline
\ \ \ \ \ \ \ \ \ finite{\isacharunderscore}subset{\isacharbrackleft}of\ {\isachardoublequoteopen}{\isacharbraceleft}a\ {\isacharminus}\ {\isadigit{1}}{\isacharless}{\isachardot}{\isachardot}{\isacharless}a{\isacharbraceright}{\isachardoublequoteclose}\ {\isacharquery}S{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}finite\ {\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharunderscore}def\ True{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \isacommand{def}\isamarkupfalse%
\ p{\isacharprime}\ {\isasymequiv}\ {\isachardoublequoteopen}p\ div\ {\isacharparenleft}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ clarsimp\isanewline
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree\ p{\isachardoublequoteclose}\ p{\isacharprime}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharbrackleft}OF\ {\isacharbackquoteopen}p{\isacharprime}\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}below\ p\ a\ {\isacharequal}\ card\ {\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharunderscore}def\ Let{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p{\isacharprime}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ p{\isacharprime}{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}between\ p\ a\ b\ {\isacharequal}\isanewline
\ \ \ \ \ {\isacharparenleft}let\ q\ {\isacharequal}\ pderiv\ p\isanewline
\ \ \ \ \ \ \ in\ if\ a\ {\isachargreater}\ b\ {\isasymor}\ p\ {\isacharequal}\ {\isadigit{0}}\ then\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ else\ if\ {\isacharparenleft}poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ q\ a\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isasymand}\ {\isacharparenleft}poly\ p\ b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ q\ b\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ then\ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm\ p\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ b{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ else\ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm{\isacharunderscore}squarefree\ p\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ b{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}a\ {\isachargreater}\ b\ {\isasymor}\ p\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharunderscore}def\ Let{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ False{\isadigit{1}}\ {\isacharequal}\ this\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymle}\ b{\isachardoublequoteclose}\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}{\isacharparenleft}poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ a\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}\ {\isasymand}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}poly\ p\ b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ b\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ False{\isadigit{1}}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Let{\isacharunderscore}def\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ a\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{and}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ B{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ b\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ b\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{def}\isamarkupfalse%
\ d\ {\isasymequiv}\ {\isachardoublequoteopen}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ div\ d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ d{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharprime}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree{\isacharprime}\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}p\ div\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ d{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharunderscore}correct\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ x\ {\isasymle}\ b\ {\isasymand}\ poly\ {\isacharparenleft}p\ div\ d{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}between{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ div\ d\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ {\isacharbackquoteopen}a\ {\isasymle}\ b{\isacharbackquoteclose}{\isacharcomma}\ symmetric{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ A{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ B{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ True\ False\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Let{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}code{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}count{\isacharunderscore}roots\ {\isacharparenleft}p{\isacharcolon}{\isacharcolon}real\ poly{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ {\isacharparenleft}if\ p\ {\isacharequal}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ \isanewline
\ \ \ \ \ else\ let\ ps\ {\isacharequal}\ sturm\ p\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ in\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}p\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharcomma}\ simp\ add{\isacharcolon}\ count{\isacharunderscore}roots{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{def}\isamarkupfalse%
\ d\ {\isasymequiv}\ {\isachardoublequoteopen}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ div\ d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ d{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharprime}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree{\isacharprime}\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}p\ div\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ d{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}correct\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}x{\isachardot}\ poly\ {\isacharparenleft}p\ div\ d{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ div\ d\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharcomma}\ symmetric{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharparenleft}{\isadigit{3}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ False\ \isacommand{unfolding}\isamarkupfalse%
\ Let{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharunderscore}code{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}above\ p\ a\ {\isacharequal}\isanewline
\ \ \ \ \ {\isacharparenleft}let\ q\ {\isacharequal}\ pderiv\ p\isanewline
\ \ \ \ \ \ \ in\ if\ p\ {\isacharequal}\ {\isadigit{0}}\ then\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ else\ if\ poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ q\ a\ {\isasymnoteq}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ then\ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm\ p\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ else\ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm{\isacharunderscore}squarefree\ p\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ sign{\isacharunderscore}changes\ ps\ a\ {\isacharminus}\ sign{\isacharunderscore}changes{\isacharunderscore}inf\ ps{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}p\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharunderscore}def\ Let{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ False{\isadigit{1}}\ {\isacharequal}\ this\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}{\isacharparenleft}poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ a\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ False{\isadigit{1}}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Let{\isacharunderscore}def\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ a\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{def}\isamarkupfalse%
\ d\ {\isasymequiv}\ {\isachardoublequoteopen}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ div\ d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ d{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharprime}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree{\isacharprime}\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}p\ div\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ d{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharunderscore}correct\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}x{\isachardot}\ a\ {\isacharless}\ x\ {\isasymand}\ poly\ {\isacharparenleft}p\ div\ d{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}above{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ div\ d\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharcomma}\ symmetric{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ A{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ True\ False\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Let{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharunderscore}code{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}count{\isacharunderscore}roots{\isacharunderscore}below\ p\ a\ {\isacharequal}\isanewline
\ \ \ \ \ {\isacharparenleft}let\ q\ {\isacharequal}\ pderiv\ p\isanewline
\ \ \ \ \ \ \ in\ if\ p\ {\isacharequal}\ {\isadigit{0}}\ then\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ else\ if\ poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ q\ a\ {\isasymnoteq}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ then\ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm\ p\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ a{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ else\ {\isacharparenleft}let\ ps\ {\isacharequal}\ sturm{\isacharunderscore}squarefree\ p\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\ sign{\isacharunderscore}changes{\isacharunderscore}neg{\isacharunderscore}inf\ ps\ {\isacharminus}\ sign{\isacharunderscore}changes\ ps\ a{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}p\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharunderscore}def\ Let{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{note}\isamarkupfalse%
\ False{\isadigit{1}}\ {\isacharequal}\ this\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}{\isacharparenleft}poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ a\ {\isasymnoteq}\ {\isadigit{0}}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ False{\isadigit{1}}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ Let{\isacharunderscore}def\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ A{\isacharcolon}\ {\isachardoublequoteopen}poly\ p\ a\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymor}\ poly\ {\isacharparenleft}pderiv\ p{\isacharparenright}\ a\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{def}\isamarkupfalse%
\ d\ {\isasymequiv}\ {\isachardoublequoteopen}gcd\ p\ {\isacharparenleft}pderiv\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}\ \isacommand{have}\isamarkupfalse%
\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ div\ d\ {\isasymnoteq}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ d{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{from}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree{\isacharprime}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ sturm{\isacharunderscore}seq{\isacharunderscore}squarefree\ {\isachardoublequoteopen}sturm{\isacharunderscore}squarefree{\isacharprime}\ p{\isachardoublequoteclose}\ {\isachardoublequoteopen}p\ div\ d{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}def\ Let{\isacharunderscore}def\ d{\isacharunderscore}def\ \isacommand{{\isachardot}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{note}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharunderscore}correct\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ p\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharbraceleft}x{\isachardot}\ x\ {\isasymle}\ a\ {\isasymand}\ poly\ {\isacharparenleft}p\ div\ d{\isacharparenright}\ x\ {\isacharequal}\ {\isadigit{0}}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ d{\isacharunderscore}def\ \isacommand{using}\isamarkupfalse%
\ poly{\isacharunderscore}div{\isacharunderscore}gcd{\isacharunderscore}squarefree{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ count{\isacharunderscore}roots{\isacharunderscore}below{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ div\ d\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharcomma}\ symmetric{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackleft}OF\ A{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{note}\isamarkupfalse%
\ sturm{\isacharunderscore}sturm{\isacharunderscore}squarefree{\isacharprime}{\isacharunderscore}same{\isacharunderscore}sign{\isacharunderscore}changes{\isacharparenleft}{\isadigit{3}}{\isacharparenright}{\isacharbrackleft}OF\ {\isacharbackquoteopen}p\ {\isasymnoteq}\ {\isadigit{0}}{\isacharbackquoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{using}\isamarkupfalse%
\ True\ False\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Let{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
\end{isabellebody}%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "root"
%%% End:
